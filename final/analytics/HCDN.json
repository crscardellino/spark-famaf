{"paragraphs":[{"text":"%md\n## Honorable Cámara de Diputados de la Nación\n### Estadísticas Generales\n\nEl presente notebook hace un anális superficial de los proyectos presentados por la HCDN, presentados entre el 1 de marzo del 2011 y 8 de noviembre del 2011.\nA partir de los datos obtenidos mediante el \"scrapping\" del sitio web de la [HCDN](http://www.hcdn.gob.ar/), se resolvió obtener toda la información que podría ser relevante para caso de estudio.\nUn primer análisis se realiza sobre los proyectos de ley en general, obteniendo estadísticas descriptivas acerca de los mismos.","dateUpdated":"2016-12-06T07:40:42-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481062714459_-1375689568","id":"20161206-191834_1472841189","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Honorable Cámara de Diputados de la Nación</h2>\n<h3>Estadísticas Generales</h3>\n<p>El presente notebook hace un anális superficial de los proyectos presentados por la HCDN, presentados entre el 1 de marzo del 2011 y 8 de noviembre del 2011.\n<br  />A partir de los datos obtenidos mediante el &ldquo;scrapping&rdquo; del sitio web de la <a href=\"http://www.hcdn.gob.ar/\">HCDN</a>, se resolvió obtener toda la información que podría ser relevante para caso de estudio.\n<br  />Un primer análisis se realiza sobre los proyectos de ley en general, obteniendo estadísticas descriptivas acerca de los mismos.</p>\n"},"dateCreated":"2016-12-06T07:18:34-0300","dateStarted":"2016-12-06T07:40:39-0300","dateFinished":"2016-12-06T07:40:39-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:106"},{"title":"Importación de librerías y creación de la sesión de Spark","text":"import java.time.LocalDate\n\nimport org.apache.spark.sql.{Column, DataFrame, Dataset, SparkSession}\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.rdd.RDD\n\nval spark = SparkSession\n  .builder()\n  .appName(\"HCDN General Stats\")\n  .getOrCreate()\n\n// for implicit conversion\nimport spark.implicits._\n\n// function to print to zeppelin table\ndef printZeppelinTable(df: DataFrame, headers: Seq[String], columns: Column*) = \n    \"%table \" + headers.mkString(\"\\t\") + \"\\n\" + df.select(columns:_*).map(_.mkString(\"\\t\")).collect.mkString(\"\\n\")","dateUpdated":"2016-12-13T14:35:20-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889650_1989838675","id":"20161119-190842_1402150266","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport java.time.LocalDate\n\nimport org.apache.spark.sql.{Column, DataFrame, Dataset, SparkSession}\n\nimport org.apache.spark.sql.expressions.Window\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.rdd.RDD\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@6736a36f\n\nimport spark.implicits._\n\nprintZeppelinTable: (df: org.apache.spark.sql.DataFrame, headers: Seq[String], columns: org.apache.spark.sql.Column*)String\n"},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T14:35:20-0300","dateFinished":"2016-12-13T14:35:56-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:107"},{"title":"Carga de los datasets obtenidos mediante la aplicación standalone","text":"val baseDir: String = \"grupo04/final/data\" // Cambiar el directorio base según corresponda\n\nval laws = spark.read.parquet(s\"$baseDir/laws.parquet\")\n    .select($\"id\", to_date(unix_timestamp($\"date\", \"yyyy-MM-dd\").cast(\"timestamp\")).as(\"date\"), $\"summary\", $\"law_text\")\nval results = spark.read.parquet(s\"$baseDir/results.parquet\")\nval signers = spark.read.parquet(s\"$baseDir/signers.parquet\")\nval deputy = spark.read.parquet(s\"$baseDir/deputyCommissions.parquet\")\nval senate = spark.read.parquet(s\"$baseDir/senateCommissions.parquet\")","dateUpdated":"2016-12-13T14:36:17-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":true,"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889692_2070635944","id":"20161119-193033_1078033333","result":{"code":"SUCCESS","type":"TEXT","msg":"\nbaseDir: String = grupo04/final/data\n\nlaws: org.apache.spark.sql.DataFrame = [id: string, date: date ... 2 more fields]\n\nresults: org.apache.spark.sql.DataFrame = [id: string, chamber: string ... 2 more fields]\n\nsigners: org.apache.spark.sql.DataFrame = [id: string, congressman: string ... 2 more fields]\n\ndeputy: org.apache.spark.sql.DataFrame = [id: string, commission: string]\n\nsenate: org.apache.spark.sql.DataFrame = [id: string, commission: string]\n"},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T14:36:17-0300","dateFinished":"2016-12-13T14:36:41-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:108"},{"title":"Estadísticas por año, mes, y mes y año","text":"val lawsMonthAndYear = laws.select($\"id\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-13T14:37:00-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481064334147_159538977","id":"20161206-194534_590181067","result":{"code":"SUCCESS","type":"TEXT","msg":"\nlawsMonthAndYear: org.apache.spark.sql.DataFrame = [id: string, month: int ... 1 more field]\n"},"dateCreated":"2016-12-06T07:45:34-0300","dateStarted":"2016-12-13T14:37:00-0300","dateFinished":"2016-12-13T14:37:01-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:109"},{"title":"Cantidad de Proyectos por Año","text":"val lawsPerYear = lawsMonthAndYear.groupBy($\"year\").count().orderBy($\"year\")\nprintZeppelinTable(lawsPerYear, List(\"Año\", \"Cantidad de Proyecto Presentados por Año\"), $\"year\", $\"count\")","dateUpdated":"2016-12-13T14:58:42-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Año","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Año","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481069599834_-2053072111","id":"20161206-211319_917818626","result":{"code":"SUCCESS","type":"TABLE","msg":"Año\tCantidad de Proyecto Presentados por Año\n2011\t1496\n2012\t2188\n2013\t1863\n2014\t2997\n2015\t1983\n2016\t2414\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Presentados por Año","value":"2011"},{"key":"Cantidad de Proyecto Presentados por Año","value":"1496"}],[{"value":"2012"},{"value":"2188"}],[{"value":"2013"},{"value":"1863"}],[{"value":"2014"},{"value":"2997"}],[{"value":"2015"},{"value":"1983"}],[{"value":"2016"},{"value":"2414"}]],"columnNames":[{"name":"Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Presentados por Año","index":1,"aggr":"sum"}],"rows":[["2011","1496"],["2012","2188"],["2013","1863"],["2014","2997"],["2015","1983"],["2016","2414"]]},"dateCreated":"2016-12-06T09:13:19-0300","dateStarted":"2016-12-13T14:58:42-0300","dateFinished":"2016-12-13T14:58:44-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:110"},{"title":"Cantidad de Proyectos por Mes","text":"val lawsPerMonth = lawsMonthAndYear.groupBy($\"month\").count().orderBy($\"month\")\nprintZeppelinTable(lawsPerMonth, List(\"Mes\", \"Cantidad de Proyecto Presentados por Mes\"), $\"month\", $\"count\")","dateUpdated":"2016-12-13T14:58:32-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Mes","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481070028091_1407051368","id":"20161206-212028_1274650191","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes\tCantidad de Proyecto Presentados por Mes\n1\t8\n2\t144\n3\t3829\n4\t1696\n5\t1295\n6\t982\n7\t684\n8\t1065\n9\t956\n10\t890\n11\t963\n12\t429\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Presentados por Mes","value":"1"},{"key":"Cantidad de Proyecto Presentados por Mes","value":"8"}],[{"value":"2"},{"value":"144"}],[{"value":"3"},{"value":"3829"}],[{"value":"4"},{"value":"1696"}],[{"value":"5"},{"value":"1295"}],[{"value":"6"},{"value":"982"}],[{"value":"7"},{"value":"684"}],[{"value":"8"},{"value":"1065"}],[{"value":"9"},{"value":"956"}],[{"value":"10"},{"value":"890"}],[{"value":"11"},{"value":"963"}],[{"value":"12"},{"value":"429"}]],"columnNames":[{"name":"Mes","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Presentados por Mes","index":1,"aggr":"sum"}],"rows":[["1","8"],["2","144"],["3","3829"],["4","1696"],["5","1295"],["6","982"],["7","684"],["8","1065"],["9","956"],["10","890"],["11","963"],["12","429"]]},"dateCreated":"2016-12-06T09:20:28-0300","dateStarted":"2016-12-13T14:58:32-0300","dateFinished":"2016-12-13T14:58:34-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"val baseLawPerMonthAndYear = (\n    for { x <- 2011 to 2016\n          y <- 1 to 12\n          if x > 2011 || y >= 3 }\n          yield (x, y, List(y, x).mkString(\"-\"), 0))\n    .toDF(\"year\", \"month\", \"monthYear\", \"count\")\n\nval lawsPerMonthAndYear = lawsMonthAndYear.groupBy($\"year\", $\"month\").count()\n    .select($\"year\", $\"month\", concat($\"month\", lit(\"-\"), $\"year\").as(\"monthYear\"), $\"count\")\n    .union(baseLawPerMonthAndYear).dropDuplicates(\"monthYear\").orderBy($\"year\", $\"month\")\n    .select($\"monthYear\", $\"count\")\n\nprintZeppelinTable(lawsPerMonthAndYear, List(\"Mes y Año\", \"Cantidad de Proyecto Presentados por Mes y Año\"), $\"monthYear\", $\"count\")","dateUpdated":"2016-12-13T14:38:18-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes y Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Presentados por Mes y Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes y Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Presentados por Mes y Año","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481071727166_1406270359","id":"20161206-214847_1314366517","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes y Año\tCantidad de Proyecto Presentados por Mes y Año\n3-2011\t482\n4-2011\t143\n5-2011\t129\n6-2011\t162\n7-2011\t94\n8-2011\t90\n9-2011\t104\n10-2011\t87\n11-2011\t141\n12-2011\t64\n1-2012\t3\n2-2012\t42\n3-2012\t807\n4-2012\t194\n5-2012\t216\n6-2012\t170\n7-2012\t96\n8-2012\t201\n9-2012\t133\n10-2012\t140\n11-2012\t145\n12-2012\t41\n1-2013\t0\n2-2013\t21\n3-2013\t540\n4-2013\t263\n5-2013\t220\n6-2013\t91\n7-2013\t117\n8-2013\t127\n9-2013\t138\n10-2013\t91\n11-2013\t144\n12-2013\t111\n1-2014\t0\n2-2014\t30\n3-2014\t731\n4-2014\t452\n5-2014\t273\n6-2014\t215\n7-2014\t161\n8-2014\t211\n9-2014\t219\n10-2014\t266\n11-2014\t304\n12-2014\t135\n1-2015\t0\n2-2015\t21\n3-2015\t678\n4-2015\t310\n5-2015\t176\n6-2015\t158\n7-2015\t115\n8-2015\t99\n9-2015\t112\n10-2015\t102\n11-2015\t134\n12-2015\t78\n1-2016\t5\n2-2016\t30\n3-2016\t591\n4-2016\t334\n5-2016\t281\n6-2016\t186\n7-2016\t101\n8-2016\t337\n9-...","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Presentados por Mes y Año","value":"3-2011"},{"key":"Cantidad de Proyecto Presentados por Mes y Año","value":"482"}],[{"value":"4-2011"},{"value":"143"}],[{"value":"5-2011"},{"value":"129"}],[{"value":"6-2011"},{"value":"162"}],[{"value":"7-2011"},{"value":"94"}],[{"value":"8-2011"},{"value":"90"}],[{"value":"9-2011"},{"value":"104"}],[{"value":"10-2011"},{"value":"87"}],[{"value":"11-2011"},{"value":"141"}],[{"value":"12-2011"},{"value":"64"}],[{"value":"1-2012"},{"value":"3"}],[{"value":"2-2012"},{"value":"42"}],[{"value":"3-2012"},{"value":"807"}],[{"value":"4-2012"},{"value":"194"}],[{"value":"5-2012"},{"value":"216"}],[{"value":"6-2012"},{"value":"170"}],[{"value":"7-2012"},{"value":"96"}],[{"value":"8-2012"},{"value":"201"}],[{"value":"9-2012"},{"value":"133"}],[{"value":"10-2012"},{"value":"140"}],[{"value":"11-2012"},{"value":"145"}],[{"value":"12-2012"},{"value":"41"}],[{"value":"1-2013"},{"value":"0"}],[{"value":"2-2013"},{"value":"21"}],[{"value":"3-2013"},{"value":"540"}],[{"value":"4-2013"},{"value":"263"}],[{"value":"5-2013"},{"value":"220"}],[{"value":"6-2013"},{"value":"91"}],[{"value":"7-2013"},{"value":"117"}],[{"value":"8-2013"},{"value":"127"}],[{"value":"9-2013"},{"value":"138"}],[{"value":"10-2013"},{"value":"91"}],[{"value":"11-2013"},{"value":"144"}],[{"value":"12-2013"},{"value":"111"}],[{"value":"1-2014"},{"value":"0"}],[{"value":"2-2014"},{"value":"30"}],[{"value":"3-2014"},{"value":"731"}],[{"value":"4-2014"},{"value":"452"}],[{"value":"5-2014"},{"value":"273"}],[{"value":"6-2014"},{"value":"215"}],[{"value":"7-2014"},{"value":"161"}],[{"value":"8-2014"},{"value":"211"}],[{"value":"9-2014"},{"value":"219"}],[{"value":"10-2014"},{"value":"266"}],[{"value":"11-2014"},{"value":"304"}],[{"value":"12-2014"},{"value":"135"}],[{"value":"1-2015"},{"value":"0"}],[{"value":"2-2015"},{"value":"21"}],[{"value":"3-2015"},{"value":"678"}],[{"value":"4-2015"},{"value":"310"}],[{"value":"5-2015"},{"value":"176"}],[{"value":"6-2015"},{"value":"158"}],[{"value":"7-2015"},{"value":"115"}],[{"value":"8-2015"},{"value":"99"}],[{"value":"9-2015"},{"value":"112"}],[{"value":"10-2015"},{"value":"102"}],[{"value":"11-2015"},{"value":"134"}],[{"value":"12-2015"},{"value":"78"}],[{"value":"1-2016"},{"value":"5"}],[{"value":"2-2016"},{"value":"30"}],[{"value":"3-2016"},{"value":"591"}],[{"value":"4-2016"},{"value":"334"}],[{"value":"5-2016"},{"value":"281"}],[{"value":"6-2016"},{"value":"186"}],[{"value":"7-2016"},{"value":"101"}],[{"value":"8-2016"},{"value":"337"}],[{"value":"9-..."}]],"columnNames":[{"name":"Mes y Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Presentados por Mes y Año","index":1,"aggr":"sum"}],"rows":[["3-2011","482"],["4-2011","143"],["5-2011","129"],["6-2011","162"],["7-2011","94"],["8-2011","90"],["9-2011","104"],["10-2011","87"],["11-2011","141"],["12-2011","64"],["1-2012","3"],["2-2012","42"],["3-2012","807"],["4-2012","194"],["5-2012","216"],["6-2012","170"],["7-2012","96"],["8-2012","201"],["9-2012","133"],["10-2012","140"],["11-2012","145"],["12-2012","41"],["1-2013","0"],["2-2013","21"],["3-2013","540"],["4-2013","263"],["5-2013","220"],["6-2013","91"],["7-2013","117"],["8-2013","127"],["9-2013","138"],["10-2013","91"],["11-2013","144"],["12-2013","111"],["1-2014","0"],["2-2014","30"],["3-2014","731"],["4-2014","452"],["5-2014","273"],["6-2014","215"],["7-2014","161"],["8-2014","211"],["9-2014","219"],["10-2014","266"],["11-2014","304"],["12-2014","135"],["1-2015","0"],["2-2015","21"],["3-2015","678"],["4-2015","310"],["5-2015","176"],["6-2015","158"],["7-2015","115"],["8-2015","99"],["9-2015","112"],["10-2015","102"],["11-2015","134"],["12-2015","78"],["1-2016","5"],["2-2016","30"],["3-2016","591"],["4-2016","334"],["5-2016","281"],["6-2016","186"],["7-2016","101"],["8-2016","337"],["9-..."]]},"dateCreated":"2016-12-06T09:48:47-0300","dateStarted":"2016-12-13T14:38:18-0300","dateFinished":"2016-12-13T14:38:25-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"text":"val sanctioned = results.filter($\"result\" === \"SANCIONADO\").select($\"id\", $\"result\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-13T16:17:41-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481656617395_-1186324262","id":"20161213-161657_863474633","dateCreated":"2016-12-13T16:16:57-0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"// Sancionados por Año\nval sanctionedPerYear = sanctioned.groupBy($\"year\").count().orderBy($\"year\")\n\nprintZeppelinTable(sanctionedPerYear, List(\"Año\", \"Cantidad de Proyecto Sancionados por Año\"), $\"year\", $\"count\")","dateUpdated":"2016-12-13T16:23:55-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Sancionados Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Sancionados Año","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481656619530_-739630789","id":"20161213-161659_1156291990","result":{"code":"SUCCESS","type":"TABLE","msg":"Año\tCantidad de Proyecto Sancionados Año\n2011\t14\n2012\t66\n2013\t61\n2014\t93\n2015\t55\n2016\t65\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados Año","value":"2011"},{"key":"Cantidad de Proyecto Sancionados Año","value":"14"}],[{"value":"2012"},{"value":"66"}],[{"value":"2013"},{"value":"61"}],[{"value":"2014"},{"value":"93"}],[{"value":"2015"},{"value":"55"}],[{"value":"2016"},{"value":"65"}]],"columnNames":[{"name":"Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados Año","index":1,"aggr":"sum"}],"rows":[["2011","14"],["2012","66"],["2013","61"],["2014","93"],["2015","55"],["2016","65"]]},"dateCreated":"2016-12-13T16:16:59-0300","dateStarted":"2016-12-13T16:18:39-0300","dateFinished":"2016-12-13T16:18:41-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"text":"// Sancionados por mes\n\nval baseSantionedPerMonth = (for { m <- 1 to 12 } yield (m, 0)).toDF(\"month\", \"count\")\n\nval sanctionedPerMonth = sanctioned.groupBy($\"month\").count()\n    .union(baseSantionedPerMonth).orderBy($\"month\")\n    \nprintZeppelinTable(sanctionedPerMonth, List(\"Mes\", \"Cantidad de Proyecto Sancionados por Mes\"), $\"month\", $\"count\")\n","dateUpdated":"2016-12-13T16:24:30-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Sancionados por Mes","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Sancionados por Mes","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481656757497_-1673969684","id":"20161213-161917_1911095402","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes\tCantidad de Proyecto Sancionados por Mes\n1\t0\n2\t0\n3\t23\n3\t0\n4\t19\n4\t0\n5\t23\n5\t0\n6\t25\n6\t0\n7\t29\n7\t0\n8\t5\n8\t0\n9\t19\n9\t0\n10\t36\n10\t0\n11\t95\n11\t0\n12\t80\n12\t0\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados por Mes","value":"1"},{"key":"Cantidad de Proyecto Sancionados por Mes","value":"0"}],[{"value":"2"},{"value":"0"}],[{"value":"3"},{"value":"23"}],[{"value":"3"},{"value":"0"}],[{"value":"4"},{"value":"19"}],[{"value":"4"},{"value":"0"}],[{"value":"5"},{"value":"23"}],[{"value":"5"},{"value":"0"}],[{"value":"6"},{"value":"25"}],[{"value":"6"},{"value":"0"}],[{"value":"7"},{"value":"29"}],[{"value":"7"},{"value":"0"}],[{"value":"8"},{"value":"5"}],[{"value":"8"},{"value":"0"}],[{"value":"9"},{"value":"19"}],[{"value":"9"},{"value":"0"}],[{"value":"10"},{"value":"36"}],[{"value":"10"},{"value":"0"}],[{"value":"11"},{"value":"95"}],[{"value":"11"},{"value":"0"}],[{"value":"12"},{"value":"80"}],[{"value":"12"},{"value":"0"}]],"columnNames":[{"name":"Mes","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados por Mes","index":1,"aggr":"sum"}],"rows":[["1","0"],["2","0"],["3","23"],["3","0"],["4","19"],["4","0"],["5","23"],["5","0"],["6","25"],["6","0"],["7","29"],["7","0"],["8","5"],["8","0"],["9","19"],["9","0"],["10","36"],["10","0"],["11","95"],["11","0"],["12","80"],["12","0"]]},"dateCreated":"2016-12-13T16:19:17-0300","dateStarted":"2016-12-13T16:23:46-0300","dateFinished":"2016-12-13T16:23:48-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"text":"// Sancionados por Mes y Año\n\nval baseSanctionedPerMonthAndYear = (\n    for { x <- 2011 to 2016\n          y <- 1 to 12\n          if x > 2011 || y >= 3 }\n          yield (x, y, List(y, x).mkString(\"-\"), 0))\n    .toDF(\"year\", \"month\", \"monthYear\", \"count\")\n\nval sanctionedPerMonthAndYear = sanctioned.groupBy($\"year\", $\"month\").count()\n    .select($\"year\", $\"month\", concat($\"month\", lit(\"-\"), $\"year\").as(\"monthYear\"), $\"count\")\n    .union(baseSanctionedPerMonthAndYear).dropDuplicates(\"monthYear\").orderBy($\"year\", $\"month\")\n    .select($\"monthYear\", $\"count\")\n\nprintZeppelinTable(sanctionedPerMonthAndYear, List(\"Mes y Año\", \"Cantidad de Proyecto Sancionados por Mes y Año\"), $\"monthYear\", $\"count\")","dateUpdated":"2016-12-13T16:27:31-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes y Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes y Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889693_2070251195","id":"20161119-195537_1087168982","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes y Año\tCantidad de Proyecto Sancionados por Mes y Año\n3-2011\t1\n4-2011\t0\n5-2011\t0\n6-2011\t1\n7-2011\t1\n8-2011\t0\n9-2011\t0\n10-2011\t0\n11-2011\t0\n12-2011\t11\n1-2012\t0\n2-2012\t0\n3-2012\t14\n4-2012\t0\n5-2012\t4\n6-2012\t0\n7-2012\t1\n8-2012\t0\n9-2012\t4\n10-2012\t0\n11-2012\t39\n12-2012\t4\n1-2013\t0\n2-2013\t0\n3-2013\t3\n4-2013\t3\n5-2013\t5\n6-2013\t11\n7-2013\t12\n8-2013\t0\n9-2013\t8\n10-2013\t0\n11-2013\t18\n12-2013\t1\n1-2014\t0\n2-2014\t0\n3-2014\t1\n4-2014\t12\n5-2014\t2\n6-2014\t0\n7-2014\t2\n8-2014\t0\n9-2014\t5\n10-2014\t4\n11-2014\t3\n12-2014\t64\n1-2015\t0\n2-2015\t0\n3-2015\t4\n4-2015\t4\n5-2015\t4\n6-2015\t5\n7-2015\t7\n8-2015\t4\n9-2015\t1\n10-2015\t10\n11-2015\t16\n12-2015\t0\n1-2016\t0\n2-2016\t0\n3-2016\t0\n4-2016\t0\n5-2016\t8\n6-2016\t8\n7-2016\t6\n8-2016\t1\n9-2016\t1\n10-2016\t22\n11-2016\t19\n12-2016\t0\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados por Mes y Año","value":"3-2011"},{"key":"Cantidad de Proyecto Sancionados por Mes y Año","value":"1"}],[{"value":"4-2011"},{"value":"0"}],[{"value":"5-2011"},{"value":"0"}],[{"value":"6-2011"},{"value":"1"}],[{"value":"7-2011"},{"value":"1"}],[{"value":"8-2011"},{"value":"0"}],[{"value":"9-2011"},{"value":"0"}],[{"value":"10-2011"},{"value":"0"}],[{"value":"11-2011"},{"value":"0"}],[{"value":"12-2011"},{"value":"11"}],[{"value":"1-2012"},{"value":"0"}],[{"value":"2-2012"},{"value":"0"}],[{"value":"3-2012"},{"value":"14"}],[{"value":"4-2012"},{"value":"0"}],[{"value":"5-2012"},{"value":"4"}],[{"value":"6-2012"},{"value":"0"}],[{"value":"7-2012"},{"value":"1"}],[{"value":"8-2012"},{"value":"0"}],[{"value":"9-2012"},{"value":"4"}],[{"value":"10-2012"},{"value":"0"}],[{"value":"11-2012"},{"value":"39"}],[{"value":"12-2012"},{"value":"4"}],[{"value":"1-2013"},{"value":"0"}],[{"value":"2-2013"},{"value":"0"}],[{"value":"3-2013"},{"value":"3"}],[{"value":"4-2013"},{"value":"3"}],[{"value":"5-2013"},{"value":"5"}],[{"value":"6-2013"},{"value":"11"}],[{"value":"7-2013"},{"value":"12"}],[{"value":"8-2013"},{"value":"0"}],[{"value":"9-2013"},{"value":"8"}],[{"value":"10-2013"},{"value":"0"}],[{"value":"11-2013"},{"value":"18"}],[{"value":"12-2013"},{"value":"1"}],[{"value":"1-2014"},{"value":"0"}],[{"value":"2-2014"},{"value":"0"}],[{"value":"3-2014"},{"value":"1"}],[{"value":"4-2014"},{"value":"12"}],[{"value":"5-2014"},{"value":"2"}],[{"value":"6-2014"},{"value":"0"}],[{"value":"7-2014"},{"value":"2"}],[{"value":"8-2014"},{"value":"0"}],[{"value":"9-2014"},{"value":"5"}],[{"value":"10-2014"},{"value":"4"}],[{"value":"11-2014"},{"value":"3"}],[{"value":"12-2014"},{"value":"64"}],[{"value":"1-2015"},{"value":"0"}],[{"value":"2-2015"},{"value":"0"}],[{"value":"3-2015"},{"value":"4"}],[{"value":"4-2015"},{"value":"4"}],[{"value":"5-2015"},{"value":"4"}],[{"value":"6-2015"},{"value":"5"}],[{"value":"7-2015"},{"value":"7"}],[{"value":"8-2015"},{"value":"4"}],[{"value":"9-2015"},{"value":"1"}],[{"value":"10-2015"},{"value":"10"}],[{"value":"11-2015"},{"value":"16"}],[{"value":"12-2015"},{"value":"0"}],[{"value":"1-2016"},{"value":"0"}],[{"value":"2-2016"},{"value":"0"}],[{"value":"3-2016"},{"value":"0"}],[{"value":"4-2016"},{"value":"0"}],[{"value":"5-2016"},{"value":"8"}],[{"value":"6-2016"},{"value":"8"}],[{"value":"7-2016"},{"value":"6"}],[{"value":"8-2016"},{"value":"1"}],[{"value":"9-2016"},{"value":"1"}],[{"value":"10-2016"},{"value":"22"}],[{"value":"11-2016"},{"value":"19"}],[{"value":"12-2016"},{"value":"0"}]],"columnNames":[{"name":"Mes y Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}],"rows":[["3-2011","1"],["4-2011","0"],["5-2011","0"],["6-2011","1"],["7-2011","1"],["8-2011","0"],["9-2011","0"],["10-2011","0"],["11-2011","0"],["12-2011","11"],["1-2012","0"],["2-2012","0"],["3-2012","14"],["4-2012","0"],["5-2012","4"],["6-2012","0"],["7-2012","1"],["8-2012","0"],["9-2012","4"],["10-2012","0"],["11-2012","39"],["12-2012","4"],["1-2013","0"],["2-2013","0"],["3-2013","3"],["4-2013","3"],["5-2013","5"],["6-2013","11"],["7-2013","12"],["8-2013","0"],["9-2013","8"],["10-2013","0"],["11-2013","18"],["12-2013","1"],["1-2014","0"],["2-2014","0"],["3-2014","1"],["4-2014","12"],["5-2014","2"],["6-2014","0"],["7-2014","2"],["8-2014","0"],["9-2014","5"],["10-2014","4"],["11-2014","3"],["12-2014","64"],["1-2015","0"],["2-2015","0"],["3-2015","4"],["4-2015","4"],["5-2015","4"],["6-2015","5"],["7-2015","7"],["8-2015","4"],["9-2015","1"],["10-2015","10"],["11-2015","16"],["12-2015","0"],["1-2016","0"],["2-2016","0"],["3-2016","0"],["4-2016","0"],["5-2016","8"],["6-2016","8"],["7-2016","6"],["8-2016","1"],["9-2016","1"],["10-2016","22"],["11-2016","19"],["12-2016","0"]]},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T16:26:45-0300","dateFinished":"2016-12-13T16:26:49-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:116"},{"text":"val halfSanction = results.filter($\"result\" === \"MEDIA SANCION\").select($\"id\", $\"result\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-13T16:32:04-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481657503379_-309974657","id":"20161213-163143_1566901836","dateCreated":"2016-12-13T16:31:43-0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:117"},{"text":"","dateUpdated":"2016-12-13T16:32:04-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481657505481_443363689","id":"20161213-163145_228033509","dateCreated":"2016-12-13T16:31:45-0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:118"},{"text":"","dateUpdated":"2016-12-13T16:32:04-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481657506678_1671097429","id":"20161213-163146_605664572","dateCreated":"2016-12-13T16:31:46-0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:119"},{"text":"println(\"Cantidad de proyectos con media sanción por Año:\")\nhalfSanction.groupBy($\"year\").count().orderBy($\"year\").show(false)\n\nprintln(\"Cantidad de proyectos con media sanción por Mes:\")\nhalfSanction.groupBy($\"month\").count().orderBy($\"month\").show(false)\n\nprintln(\"Cantidad de proyectos con media sanción por Mes y Año:\")\nhalfSanction.groupBy($\"year\", $\"month\").count().orderBy($\"year\", $\"month\").show(false)","dateUpdated":"2016-12-13T16:32:04-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889693_2070251195","id":"20161119-202954_202626127","result":{"code":"SUCCESS","type":"TEXT","msg":"\nhalfSanction: org.apache.spark.sql.DataFrame = [id: string, result: string ... 2 more fields]\nCantidad de proyectos con media sanción por Año:\n+----+-----+\n|year|count|\n+----+-----+\n|2011|31   |\n|2012|225  |\n|2013|110  |\n|2014|189  |\n|2015|171  |\n|2016|47   |\n+----+-----+\n\nCantidad de proyectos con media sanción por Mes:\n+-----+-----+\n|month|count|\n+-----+-----+\n|3    |3    |\n|4    |32   |\n|5    |10   |\n|6    |69   |\n|7    |33   |\n|8    |50   |\n|9    |57   |\n|10   |57   |\n|11   |391  |\n|12   |71   |\n+-----+-----+\n\nCantidad de proyectos con media sanción por Mes y Año:\n+----+-----+-----+\n|year|month|count|\n+----+-----+-----+\n|2011|3    |1    |\n|2011|5    |1    |\n|2011|6    |1    |\n|2011|9    |3    |\n|2011|11   |14   |\n|2011|12   |11   |\n|2012|4    |15   |\n|2012|5    |5    |\n|2012|6    |27   |\n|2012|8    |13   |\n|2012|10   |36   |\n|2012|11   |129  |\n|2013|4    |11   |\n|2013|6    |15   |\n|2013|7    |12   |\n|2013|9    |17   |\n|2013|11   |54   |\n|2013|12   |1    |\n|2014|7    |10   |\n|2014|8    |19   |\n+----+-----+-----+\nonly showing top 20 rows\n\n"},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T14:55:13-0300","dateFinished":"2016-12-13T14:55:17-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"val amountOfProjects = Seq((\"PRESENTADO\", laws.count())).toDF()\n\nval grouped = results.groupBy(\"result\").agg(countDistinct($\"id\").as(\"amount\"))\nval allGrouped = grouped.union(amountOfProjects).toDF()\n\nprintZeppelinTable(allGrouped, List(\"Categoria\", \"Cantidad\"), $\"result\", $\"amount\")","dateUpdated":"2016-12-13T15:36:20-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Categoria","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Categoria","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad","index":1,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889694_2071405441","id":"20161119-221416_434910484","result":{"code":"SUCCESS","type":"TABLE","msg":"Categoria\tCantidad\nSANCIONADO\t354\nAPROBADO\t2\nRETIRADO\t22\nMEDIA SANCION\t714\nPRESENTADO\t12941\n","comment":"","msgTable":[[{"key":"Cantidad","value":"SANCIONADO"},{"key":"Cantidad","value":"354"}],[{"value":"APROBADO"},{"value":"2"}],[{"value":"RETIRADO"},{"value":"22"}],[{"value":"MEDIA SANCION"},{"value":"714"}],[{"value":"PRESENTADO"},{"value":"12941"}]],"columnNames":[{"name":"Categoria","index":0,"aggr":"sum"},{"name":"Cantidad","index":1,"aggr":"sum"}],"rows":[["SANCIONADO","354"],["APROBADO","2"],["RETIRADO","22"],["MEDIA SANCION","714"],["PRESENTADO","12941"]]},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T15:35:55-0300","dateFinished":"2016-12-13T15:35:59-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"// Proyectos totales por partido.\nval signersByParty = signers.groupBy($\"party\").agg(countDistinct($\"id\").as(\"count\")).orderBy(desc(\"count\"))\n\nprintZeppelinTable(signersByParty, List(\"Partido\", \"Cantidad de Proyectos Presentados\"), $\"party\", $\"count\")","dateUpdated":"2016-12-13T15:46:44-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Partido","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyectos Presentados","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Partido","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyectos Presentados","index":1,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889694_2071405441","id":"20161121-180050_1746410658","result":{"code":"SUCCESS","type":"TABLE","msg":"Partido\tCantidad de Proyectos Presentados\nFRENTE PARA LA VICTORIA - PJ\t3940\nUCR\t2608\nGEN\t1007\nUNION PRO\t985\nPARTIDO SOCIALISTA\t788\nLIBRES DEL SUR\t593\nMOV POP NEUQUINO\t572\nFRENTE PERONISTA\t541\nPRO\t516\nCOMPROMISO FEDERAL\t488\nUNIDAD POPULAR\t446\nFRENTE RENOVADOR\t400\nUNIR\t397\nFEDERAL UNIDOS POR UNA NUEVA ARGENTINA\t372\nFRENTE CIVICO - CORDOBA\t330\nCOALICION CIVICA\t323\nCOALICION CIVICA - ARI\t298\nUDESO SALTA\t266\nJUSTICIALISTA\t213\nTRABAJO Y DIGNIDAD\t205\nPARTIDO JUSTICIALISTA LA PAMPA\t201\nFRENTE PARA LA VICTORIA - PARTIDO BLOQUISTA\t200\nPERONISMO FEDERAL\t198\nCOALICION CIVICA ARI - UNEN\t185\nPROYECTO SUR - UNEN\t168\nMOVIMIENTO PROYECTO SUR\t151\nFRENTE CIVICO POR SANTIAGO\t149\nFRENTE CIVICO Y SOCIAL DE CATAMARCA\t145\nUNION POR TODOS\t144\nUNIDOS POR UNA NUEVA ARGENTINA\t116\nUNION CELE...","comment":"","msgTable":[[{"key":"Cantidad de Proyectos Presentados","value":"FRENTE PARA LA VICTORIA - PJ"},{"key":"Cantidad de Proyectos Presentados","value":"3940"}],[{"value":"UCR"},{"value":"2608"}],[{"value":"GEN"},{"value":"1007"}],[{"value":"UNION PRO"},{"value":"985"}],[{"value":"PARTIDO SOCIALISTA"},{"value":"788"}],[{"value":"LIBRES DEL SUR"},{"value":"593"}],[{"value":"MOV POP NEUQUINO"},{"value":"572"}],[{"value":"FRENTE PERONISTA"},{"value":"541"}],[{"value":"PRO"},{"value":"516"}],[{"value":"COMPROMISO FEDERAL"},{"value":"488"}],[{"value":"UNIDAD POPULAR"},{"value":"446"}],[{"value":"FRENTE RENOVADOR"},{"value":"400"}],[{"value":"UNIR"},{"value":"397"}],[{"value":"FEDERAL UNIDOS POR UNA NUEVA ARGENTINA"},{"value":"372"}],[{"value":"FRENTE CIVICO - CORDOBA"},{"value":"330"}],[{"value":"COALICION CIVICA"},{"value":"323"}],[{"value":"COALICION CIVICA - ARI"},{"value":"298"}],[{"value":"UDESO SALTA"},{"value":"266"}],[{"value":"JUSTICIALISTA"},{"value":"213"}],[{"value":"TRABAJO Y DIGNIDAD"},{"value":"205"}],[{"value":"PARTIDO JUSTICIALISTA LA PAMPA"},{"value":"201"}],[{"value":"FRENTE PARA LA VICTORIA - PARTIDO BLOQUISTA"},{"value":"200"}],[{"value":"PERONISMO FEDERAL"},{"value":"198"}],[{"value":"COALICION CIVICA ARI - UNEN"},{"value":"185"}],[{"value":"PROYECTO SUR - UNEN"},{"value":"168"}],[{"value":"MOVIMIENTO PROYECTO SUR"},{"value":"151"}],[{"value":"FRENTE CIVICO POR SANTIAGO"},{"value":"149"}],[{"value":"FRENTE CIVICO Y SOCIAL DE CATAMARCA"},{"value":"145"}],[{"value":"UNION POR TODOS"},{"value":"144"}],[{"value":"UNIDOS POR UNA NUEVA ARGENTINA"},{"value":"116"}],[{"value":"UNION CELE..."}]],"columnNames":[{"name":"Partido","index":0,"aggr":"sum"},{"name":"Cantidad de Proyectos Presentados","index":1,"aggr":"sum"}],"rows":[["FRENTE PARA LA VICTORIA - PJ","3940"],["UCR","2608"],["GEN","1007"],["UNION PRO","985"],["PARTIDO SOCIALISTA","788"],["LIBRES DEL SUR","593"],["MOV POP NEUQUINO","572"],["FRENTE PERONISTA","541"],["PRO","516"],["COMPROMISO FEDERAL","488"],["UNIDAD POPULAR","446"],["FRENTE RENOVADOR","400"],["UNIR","397"],["FEDERAL UNIDOS POR UNA NUEVA ARGENTINA","372"],["FRENTE CIVICO - CORDOBA","330"],["COALICION CIVICA","323"],["COALICION CIVICA - ARI","298"],["UDESO SALTA","266"],["JUSTICIALISTA","213"],["TRABAJO Y DIGNIDAD","205"],["PARTIDO JUSTICIALISTA LA PAMPA","201"],["FRENTE PARA LA VICTORIA - PARTIDO BLOQUISTA","200"],["PERONISMO FEDERAL","198"],["COALICION CIVICA ARI - UNEN","185"],["PROYECTO SUR - UNEN","168"],["MOVIMIENTO PROYECTO SUR","151"],["FRENTE CIVICO POR SANTIAGO","149"],["FRENTE CIVICO Y SOCIAL DE CATAMARCA","145"],["UNION POR TODOS","144"],["UNIDOS POR UNA NUEVA ARGENTINA","116"],["UNION CELE..."]]},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T15:46:44-0300","dateFinished":"2016-12-13T15:46:50-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"def getAmountOfMonths: Long => Long = _.toLong / 30\n\n\n//Tiempo hasta conseguir media sanción\nval timeMediaSancion = resultados.select($\"id\", $\"result\", $\"date\".alias(\"resultdate\")).join(leyes, \"id\").select($\"id\",$\"date\".alias(\"presentationdate\"),$\"result\",$\"resultdate\").withColumn(\"Diferencia (Días)\", datediff($\"resultdate\", $\"presentationdate\")).filter($\"result\" === \"MEDIA SANCION\").withColumn(\"Diferencia (Meses)\", udf(getAmountOfMonths).apply($\"Diferencia (Días)\"))\n\n//Tiempo hasta conseguir sanción completa\nval timeSancion = resultados.select($\"id\", $\"result\", $\"date\".alias(\"resultdate\")).join(leyes, \"id\").select($\"id\",$\"date\".alias(\"presentationdate\"),$\"result\",$\"resultdate\").withColumn(\"Diferencia (Días)\", datediff($\"resultdate\", $\"presentationdate\")).filter($\"result\" === \"SANCIONADO\").withColumn(\"Diferencia (Meses)\", udf(getAmountOfMonths).apply($\"Diferencia (Días)\"))","dateUpdated":"2016-12-06T03:15:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889696_2056784983","id":"20161123-161550_1595936538","dateCreated":"2016-12-06T03:11:29-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"val histogramMediaSancion = timeMediaSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\nhistogramMediaSancion.show(100)","dateUpdated":"2016-12-06T03:15:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889697_2056400234","id":"20161123-163609_1230029729","dateCreated":"2016-12-06T03:11:29-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"val histogramSancion = timeSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\nhistogramSancion.show(100)","dateUpdated":"2016-12-06T03:15:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889697_2056400234","id":"20161123-165928_1330376200","dateCreated":"2016-12-06T03:11:29-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"text":"val signersPerProject = signers.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"total_signers\"))\n\n","dateUpdated":"2016-12-13T16:16:14-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889696_2056784983","id":"20161123-161130_893023380","result":{"code":"SUCCESS","type":"TEXT","msg":"+-----------+---------------------+\n|         id|Cantidad de Firmantes|\n+-----------+---------------------+\n|0001-D-2011|                    1|\n|0002-D-2011|                    1|\n|0002-D-2014|                    6|\n|0003-D-2012|                    6|\n|0003-D-2013|                    1|\n|0003-D-2014|                    8|\n|0003-D-2015|                   12|\n|0004-D-2013|                    1|\n|0004-D-2014|                    4|\n|0004-D-2015|                    8|\n|0005-D-2011|                    3|\n|0005-D-2012|                    3|\n|0005-D-2013|                    1|\n|0005-D-2014|                    4|\n|0005-D-2015|                    6|\n|0005-D-2016|                    1|\n|0006-D-2011|                    5|\n|0006-D-2012|                    4|\n|0006-D-2013|                    2|\n|0006-D-2015|                    6|\n+-----------+---------------------+\nonly showing top 20 rows\n\n"},"dateCreated":"2016-12-06T03:11:29-0300","dateStarted":"2016-12-13T16:13:11-0300","dateFinished":"2016-12-13T16:13:37-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"text":"val projectsPerDeputy = signers.groupBy(\"congressman\")\n\n//Top 20 Cantidad de proyectos presentados por diputado\nsigners.groupBy(\"congressman\").agg(countDistinct(\"id\").as(\"#Proyectos Presentados\")).sort(desc(\"#Proyectos Presentados\")).show(20)\n\n//Bottom 20 Cantidad de proyectos presentados por diputado\nsigners.groupBy(\"congressman\").agg(countDistinct(\"id\").as(\"#Proyectos Presentados\")).sort(asc(\"#Proyectos Presentados\")).show(20)\n\n//Cantidad de partidos firmantes por proyecto\nval partiesPerProject = signers.groupBy(\"id\").agg(countDistinct(\"party\").as(\"#Partidos por Proyecto\"))\n\n//Top 20\npartidosPorProyecto.sort(desc(\"#Partidos por Proyecto\")).show()\n\npartidosPorProyecto.select(avg(\"#Partidos por Proyecto\").as(\"Promedio de partidos firmantes por proyecto\")).show()\n\nval rowMaxOverTwo = partidosPorProyecto.count.toFloat / 2\npartidosPorProyecto.select($\"#Partidos por Proyecto\", row_number.over(Window.orderBy($\"#Partidos por Proyecto\")).as(\"rowIndex\"))\n    .select($\"#Partidos por Proyecto\", $\"rowIndex\", ($\"rowIndex\" - rowMaxOverTwo).as(\"filterRow\")).where($\"filterRow\" >= 0 && $\"filterRow\" <= 1)\n    .agg(avg($\"#Partidos por Proyecto\").as(\"Mediana de Partidos por Proyecto\")).show(false)\n","dateUpdated":"2016-12-13T16:39:49-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889698_2057554481","id":"20161123-184222_1304745763","dateCreated":"2016-12-06T03:11:29-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"text":"val diputadosPorProyecto = firmantes.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"#Diputados por Proyecto\"))\n\ndiputadosPorProyecto.select(avg(\"#Diputados por Proyecto\").as(\"Promedio de diputados firmantes por proyecto\")).show()\n\nval rowMaxOverTwo2 = diputadosPorProyecto.count.toFloat / 2\ndiputadosPorProyecto.select($\"#Diputados por Proyecto\", row_number.over(Window.orderBy($\"#Diputados por Proyecto\")).as(\"rowIndex\"))\n    .select($\"#Diputados por Proyecto\", $\"rowIndex\", ($\"rowIndex\" - rowMaxOverTwo2).as(\"filterRow\")).where($\"filterRow\" >= 0 && $\"filterRow\" <= 1)\n    .agg(avg($\"#Diputados por Proyecto\").as(\"Mediana de Diputados por Proyecto\")).show(false)","dateUpdated":"2016-12-06T03:15:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889699_2057169732","id":"20161123-184322_700111182","dateCreated":"2016-12-06T03:11:29-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:128"},{"text":"","dateUpdated":"2016-12-06T03:15:53-0300","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481047889699_2057169732","id":"20161123-225914_761807549","dateCreated":"2016-12-06T03:11:29-0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:129"}],"name":"HCDN: Estadísticas Generales","id":"2C46CG3PM","angularObjects":{"2C2XT33G1:shared_process":[],"2C263UDKK:shared_process":[],"2BZQP7FP2:shared_process":[],"2C23FW81F:shared_process":[],"2C3EE4HU4:shared_process":[],"2C2KKEMWN:shared_process":[],"2BYT7ENXJ:shared_process":[],"2BYZMUBD9:shared_process":[],"2C1HD5GBB:shared_process":[],"2C31H66JG:shared_process":[],"2C1DFBGKY:shared_process":[],"2C1T2FY1C:shared_process":[],"2C1TS1PZ4:shared_process":[],"2C1ZVKWTZ:shared_process":[],"2C383Y25P:shared_process":[],"2C2MXESVD:shared_process":[],"2BZ93H6EZ:shared_process":[],"2BYN16RU5:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}