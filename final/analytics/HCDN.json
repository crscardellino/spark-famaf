{"paragraphs":[{"text":"%md\n## Honorable Cámara de Diputados de la Nación\n### Estadísticas Generales\n\nEl presente notebook hace un anális superficial de los proyectos presentados por la HCDN, presentados entre el 1 de marzo del 2011 y 8 de noviembre del 2011.\nA partir de los datos obtenidos mediante el \"scrapping\" del sitio web de la [HCDN](http://www.hcdn.gob.ar/), se resolvió obtener toda la información que podría ser relevante para caso de estudio.\nUn primer análisis se realiza sobre los proyectos de ley en general, obteniendo estadísticas descriptivas acerca de los mismos.","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562820_-467001012","id":"20161206-191834_1472841189","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Honorable Cámara de Diputados de la Nación</h2>\n<h3>Estadísticas Generales</h3>\n<p>El presente notebook hace un anális superficial de los proyectos presentados por la HCDN, presentados entre el 1 de marzo del 2011 y 8 de noviembre del 2011.\n<br  />A partir de los datos obtenidos mediante el &ldquo;scrapping&rdquo; del sitio web de la <a href=\"http://www.hcdn.gob.ar/\">HCDN</a>, se resolvió obtener toda la información que podría ser relevante para caso de estudio.\n<br  />Un primer análisis se realiza sobre los proyectos de ley en general, obteniendo estadísticas descriptivas acerca de los mismos.</p>\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:57:55-0300","dateFinished":"2016-12-14T12:57:55-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3153"},{"title":"Importación de librerías y creación de la sesión de Spark","text":"import java.time.LocalDate\n\nimport org.apache.spark.sql.{Column, DataFrame, Dataset, SparkSession}\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.rdd.RDD\n\nval spark = SparkSession\n  .builder()\n  .appName(\"HCDN General Stats\")\n  .getOrCreate()\n\n// for implicit conversion\nimport spark.implicits._\n\n// function to print to zeppelin table\ndef printZeppelinTable(df: DataFrame, headers: Seq[String], columns: Column*) = \n    \"%table \" + headers.mkString(\"\\t\") + \"\\n\" + df.select(columns:_*).map(_.mkString(\"\\t\")).collect.mkString(\"\\n\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562823_-466616263","id":"20161119-190842_1402150266","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport java.time.LocalDate\n\nimport org.apache.spark.sql.{Column, DataFrame, Dataset, SparkSession}\n\nimport org.apache.spark.sql.expressions.Window\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.rdd.RDD\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@49c619dd\n\nimport spark.implicits._\n\nprintZeppelinTable: (df: org.apache.spark.sql.DataFrame, headers: Seq[String], columns: org.apache.spark.sql.Column*)String\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:57:55-0300","dateFinished":"2016-12-14T12:57:57-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3154"},{"title":"Carga de los datasets obtenidos mediante la aplicación standalone","text":"val baseDir: String = \"../datos/parquets\" // Cambiar el directorio base según corresponda\n\nval laws = spark.read.parquet(s\"$baseDir/laws.parquet\")\n    .select($\"id\", to_date(unix_timestamp($\"date\", \"yyyy-MM-dd\").cast(\"timestamp\")).as(\"date\"), $\"summary\", $\"law_text\")\nval results = spark.read.parquet(s\"$baseDir/results.parquet\")\nval signers = spark.read.parquet(s\"$baseDir/signers.parquet\")\nval deputy = spark.read.parquet(s\"$baseDir/deputyCommissions.parquet\")\nval senate = spark.read.parquet(s\"$baseDir/senateCommissions.parquet\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562824_-468540007","id":"20161119-193033_1078033333","result":{"code":"SUCCESS","type":"TEXT","msg":"\nbaseDir: String = ../datos/parquets\n\nlaws: org.apache.spark.sql.DataFrame = [id: string, date: date ... 2 more fields]\n\nresults: org.apache.spark.sql.DataFrame = [id: string, chamber: string ... 2 more fields]\n\nsigners: org.apache.spark.sql.DataFrame = [id: string, congressman: string ... 2 more fields]\n\ndeputy: org.apache.spark.sql.DataFrame = [id: string, commission: string]\n\nsenate: org.apache.spark.sql.DataFrame = [id: string, commission: string]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:57:56-0300","dateFinished":"2016-12-14T12:57:58-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3155"},{"title":"Estadísticas por año, mes, y mes y año","text":"val lawsMonthAndYear = laws.select($\"id\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-14T14:29:53-0300","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562824_-468540007","id":"20161206-194534_590181067","result":{"code":"SUCCESS","type":"TEXT","msg":"\nlawsMonthAndYear: org.apache.spark.sql.DataFrame = [id: string, month: int ... 1 more field]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T13:53:22-0300","dateFinished":"2016-12-14T13:53:22-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3156","focus":true},{"title":"Cantidad de Proyectos por Año","text":"val lawsPerYear = lawsMonthAndYear.groupBy($\"year\").count().orderBy($\"year\")\nprintZeppelinTable(lawsPerYear, List(\"Año\", \"Cantidad de Proyecto Presentados por Año\"), $\"year\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Año","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Año","index":0,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562825_-468924756","id":"20161206-211319_917818626","result":{"code":"SUCCESS","type":"TABLE","msg":"Año\tCantidad de Proyecto Presentados por Año\n2011\t1496\n2012\t2188\n2013\t1863\n2014\t2997\n2015\t1983\n2016\t2414\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Presentados por Año","value":"2011"},{"key":"Cantidad de Proyecto Presentados por Año","value":"1496"}],[{"value":"2012"},{"value":"2188"}],[{"value":"2013"},{"value":"1863"}],[{"value":"2014"},{"value":"2997"}],[{"value":"2015"},{"value":"1983"}],[{"value":"2016"},{"value":"2414"}]],"columnNames":[{"name":"Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Presentados por Año","index":1,"aggr":"sum"}],"rows":[["2011","1496"],["2012","2188"],["2013","1863"],["2014","2997"],["2015","1983"],["2016","2414"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T13:53:24-0300","dateFinished":"2016-12-14T13:53:25-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3157","focus":true},{"title":"Cantidad de Proyectos por Mes","text":"val lawsPerMonth = lawsMonthAndYear.groupBy($\"month\").count().orderBy($\"month\")\nprintZeppelinTable(lawsPerMonth, List(\"Mes\", \"Cantidad de Proyecto Presentados por Mes\"), $\"month\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Mes","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562826_-467770510","id":"20161206-212028_1274650191","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes\tCantidad de Proyecto Presentados por Mes\n1\t8\n2\t144\n3\t3829\n4\t1696\n5\t1295\n6\t982\n7\t684\n8\t1065\n9\t956\n10\t890\n11\t963\n12\t429\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Presentados por Mes","value":"1"},{"key":"Cantidad de Proyecto Presentados por Mes","value":"8"}],[{"value":"2"},{"value":"144"}],[{"value":"3"},{"value":"3829"}],[{"value":"4"},{"value":"1696"}],[{"value":"5"},{"value":"1295"}],[{"value":"6"},{"value":"982"}],[{"value":"7"},{"value":"684"}],[{"value":"8"},{"value":"1065"}],[{"value":"9"},{"value":"956"}],[{"value":"10"},{"value":"890"}],[{"value":"11"},{"value":"963"}],[{"value":"12"},{"value":"429"}]],"columnNames":[{"name":"Mes","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Presentados por Mes","index":1,"aggr":"sum"}],"rows":[["1","8"],["2","144"],["3","3829"],["4","1696"],["5","1295"],["6","982"],["7","684"],["8","1065"],["9","956"],["10","890"],["11","963"],["12","429"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T13:53:28-0300","dateFinished":"2016-12-14T13:53:29-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3158","focus":true},{"text":"val baseLawPerMonthAndYear = (\n    for { x <- 2011 to 2016\n          y <- 1 to 12\n          if x > 2011 || y >= 3 }\n          yield (x, y, List(y, x).mkString(\"-\"), 0))\n    .toDF(\"year\", \"month\", \"monthYear\", \"count\")\n\nval lawsPerMonthAndYear = lawsMonthAndYear.groupBy($\"year\", $\"month\").count()\n    .select($\"year\", $\"month\", concat($\"month\", lit(\"-\"), $\"year\").as(\"monthYear\"), $\"count\")\n    .union(baseLawPerMonthAndYear).dropDuplicates(\"monthYear\").orderBy($\"year\", $\"month\")\n    .select($\"monthYear\", $\"count\")\n\nprintZeppelinTable(lawsPerMonthAndYear, List(\"Mes y Año\", \"Cantidad de Proyecto Presentados por Mes y Año\"), $\"monthYear\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes y Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Presentados por Mes y Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes y Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Presentados por Mes y Año","index":1,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562826_-467770510","id":"20161206-214847_1314366517","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes y Año\tCantidad de Proyecto Presentados por Mes y Año\n3-2011\t482\n4-2011\t143\n5-2011\t129\n6-2011\t162\n7-2011\t94\n8-2011\t90\n9-2011\t104\n10-2011\t87\n11-2011\t141\n12-2011\t64\n1-2012\t3\n2-2012\t42\n3-2012\t807\n4-2012\t194\n5-2012\t216\n6-2012\t170\n7-2012\t96\n8-2012\t201\n9-2012\t133\n10-2012\t140\n11-2012\t145\n12-2012\t41\n1-2013\t0\n2-2013\t21\n3-2013\t540\n4-2013\t263\n5-2013\t220\n6-2013\t91\n7-2013\t117\n8-2013\t127\n9-2013\t138\n10-2013\t91\n11-2013\t144\n12-2013\t111\n1-2014\t0\n2-2014\t30\n3-2014\t731\n4-2014\t452\n5-2014\t273\n6-2014\t215\n7-2014\t161\n8-2014\t211\n9-2014\t219\n10-2014\t266\n11-2014\t304\n12-2014\t135\n1-2015\t0\n2-2015\t21\n3-2015\t678\n4-2015\t310\n5-2015\t176\n6-2015\t158\n7-2015\t115\n8-2015\t99\n9-2015\t112\n10-2015\t102\n11-2015\t134\n12-2015\t78\n1-2016\t5\n2-2016\t30\n3-2016\t591\n4-2016\t334\n5-2016\t281\n6-2016\t186\n7-2016\t101\n8-2016\t337\n9...","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Presentados por Mes y Año","value":"3-2011"},{"key":"Cantidad de Proyecto Presentados por Mes y Año","value":"482"}],[{"value":"4-2011"},{"value":"143"}],[{"value":"5-2011"},{"value":"129"}],[{"value":"6-2011"},{"value":"162"}],[{"value":"7-2011"},{"value":"94"}],[{"value":"8-2011"},{"value":"90"}],[{"value":"9-2011"},{"value":"104"}],[{"value":"10-2011"},{"value":"87"}],[{"value":"11-2011"},{"value":"141"}],[{"value":"12-2011"},{"value":"64"}],[{"value":"1-2012"},{"value":"3"}],[{"value":"2-2012"},{"value":"42"}],[{"value":"3-2012"},{"value":"807"}],[{"value":"4-2012"},{"value":"194"}],[{"value":"5-2012"},{"value":"216"}],[{"value":"6-2012"},{"value":"170"}],[{"value":"7-2012"},{"value":"96"}],[{"value":"8-2012"},{"value":"201"}],[{"value":"9-2012"},{"value":"133"}],[{"value":"10-2012"},{"value":"140"}],[{"value":"11-2012"},{"value":"145"}],[{"value":"12-2012"},{"value":"41"}],[{"value":"1-2013"},{"value":"0"}],[{"value":"2-2013"},{"value":"21"}],[{"value":"3-2013"},{"value":"540"}],[{"value":"4-2013"},{"value":"263"}],[{"value":"5-2013"},{"value":"220"}],[{"value":"6-2013"},{"value":"91"}],[{"value":"7-2013"},{"value":"117"}],[{"value":"8-2013"},{"value":"127"}],[{"value":"9-2013"},{"value":"138"}],[{"value":"10-2013"},{"value":"91"}],[{"value":"11-2013"},{"value":"144"}],[{"value":"12-2013"},{"value":"111"}],[{"value":"1-2014"},{"value":"0"}],[{"value":"2-2014"},{"value":"30"}],[{"value":"3-2014"},{"value":"731"}],[{"value":"4-2014"},{"value":"452"}],[{"value":"5-2014"},{"value":"273"}],[{"value":"6-2014"},{"value":"215"}],[{"value":"7-2014"},{"value":"161"}],[{"value":"8-2014"},{"value":"211"}],[{"value":"9-2014"},{"value":"219"}],[{"value":"10-2014"},{"value":"266"}],[{"value":"11-2014"},{"value":"304"}],[{"value":"12-2014"},{"value":"135"}],[{"value":"1-2015"},{"value":"0"}],[{"value":"2-2015"},{"value":"21"}],[{"value":"3-2015"},{"value":"678"}],[{"value":"4-2015"},{"value":"310"}],[{"value":"5-2015"},{"value":"176"}],[{"value":"6-2015"},{"value":"158"}],[{"value":"7-2015"},{"value":"115"}],[{"value":"8-2015"},{"value":"99"}],[{"value":"9-2015"},{"value":"112"}],[{"value":"10-2015"},{"value":"102"}],[{"value":"11-2015"},{"value":"134"}],[{"value":"12-2015"},{"value":"78"}],[{"value":"1-2016"},{"value":"5"}],[{"value":"2-2016"},{"value":"30"}],[{"value":"3-2016"},{"value":"591"}],[{"value":"4-2016"},{"value":"334"}],[{"value":"5-2016"},{"value":"281"}],[{"value":"6-2016"},{"value":"186"}],[{"value":"7-2016"},{"value":"101"}],[{"value":"8-2016"},{"value":"337"}],[{"value":"9..."}]],"columnNames":[{"name":"Mes y Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Presentados por Mes y Año","index":1,"aggr":"sum"}],"rows":[["3-2011","482"],["4-2011","143"],["5-2011","129"],["6-2011","162"],["7-2011","94"],["8-2011","90"],["9-2011","104"],["10-2011","87"],["11-2011","141"],["12-2011","64"],["1-2012","3"],["2-2012","42"],["3-2012","807"],["4-2012","194"],["5-2012","216"],["6-2012","170"],["7-2012","96"],["8-2012","201"],["9-2012","133"],["10-2012","140"],["11-2012","145"],["12-2012","41"],["1-2013","0"],["2-2013","21"],["3-2013","540"],["4-2013","263"],["5-2013","220"],["6-2013","91"],["7-2013","117"],["8-2013","127"],["9-2013","138"],["10-2013","91"],["11-2013","144"],["12-2013","111"],["1-2014","0"],["2-2014","30"],["3-2014","731"],["4-2014","452"],["5-2014","273"],["6-2014","215"],["7-2014","161"],["8-2014","211"],["9-2014","219"],["10-2014","266"],["11-2014","304"],["12-2014","135"],["1-2015","0"],["2-2015","21"],["3-2015","678"],["4-2015","310"],["5-2015","176"],["6-2015","158"],["7-2015","115"],["8-2015","99"],["9-2015","112"],["10-2015","102"],["11-2015","134"],["12-2015","78"],["1-2016","5"],["2-2016","30"],["3-2016","591"],["4-2016","334"],["5-2016","281"],["6-2016","186"],["7-2016","101"],["8-2016","337"],["9..."]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:57:59-0300","dateFinished":"2016-12-14T12:58:02-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3159"},{"text":"val sanctioned = results.filter($\"result\" === \"SANCIONADO\").select($\"id\", $\"result\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562828_-470079003","id":"20161213-161657_863474633","result":{"code":"SUCCESS","type":"TEXT","msg":"\nsanctioned: org.apache.spark.sql.DataFrame = [id: string, result: string ... 2 more fields]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:00-0300","dateFinished":"2016-12-14T12:58:02-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3160"},{"text":"// Sancionados por Año\nval sanctionedPerYear = sanctioned.groupBy($\"year\").count().orderBy($\"year\")\n\nprintZeppelinTable(sanctionedPerYear, List(\"Año\", \"Cantidad de Proyecto Sancionados por Año\"), $\"year\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Año","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Año","index":0,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562828_-470079003","id":"20161213-161659_1156291990","result":{"code":"SUCCESS","type":"TABLE","msg":"Año\tCantidad de Proyecto Sancionados por Año\n2011\t14\n2012\t66\n2013\t61\n2014\t93\n2015\t55\n2016\t65\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados por Año","value":"2011"},{"key":"Cantidad de Proyecto Sancionados por Año","value":"14"}],[{"value":"2012"},{"value":"66"}],[{"value":"2013"},{"value":"61"}],[{"value":"2014"},{"value":"93"}],[{"value":"2015"},{"value":"55"}],[{"value":"2016"},{"value":"65"}]],"columnNames":[{"name":"Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados por Año","index":1,"aggr":"sum"}],"rows":[["2011","14"],["2012","66"],["2013","61"],["2014","93"],["2015","55"],["2016","65"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:02-0300","dateFinished":"2016-12-14T12:58:03-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3161"},{"text":"// Sancionados por mes\n\nval baseSanctionedPerMonth = (for { m <- 1 to 12 } yield (m, 0)).toDF(\"month\", \"count\")\n\nval sanctionedPerMonth = sanctioned.groupBy($\"month\").count()\n    .union(baseSanctionedPerMonth).orderBy($\"month\")\n    \nprintZeppelinTable(sanctionedPerMonth, List(\"Mes\", \"Cantidad de Proyecto Sancionados por Mes\"), $\"month\", $\"count\")\n","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Sancionados por Mes","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Sancionados por Mes","index":1,"aggr":"sum"}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562829_-470463752","id":"20161213-161917_1911095402","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes\tCantidad de Proyecto Sancionados por Mes\n1\t0\n2\t0\n3\t23\n3\t0\n4\t19\n4\t0\n5\t23\n5\t0\n6\t25\n6\t0\n7\t29\n7\t0\n8\t5\n8\t0\n9\t19\n9\t0\n10\t36\n10\t0\n11\t95\n11\t0\n12\t80\n12\t0\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados por Mes","value":"1"},{"key":"Cantidad de Proyecto Sancionados por Mes","value":"0"}],[{"value":"2"},{"value":"0"}],[{"value":"3"},{"value":"23"}],[{"value":"3"},{"value":"0"}],[{"value":"4"},{"value":"19"}],[{"value":"4"},{"value":"0"}],[{"value":"5"},{"value":"23"}],[{"value":"5"},{"value":"0"}],[{"value":"6"},{"value":"25"}],[{"value":"6"},{"value":"0"}],[{"value":"7"},{"value":"29"}],[{"value":"7"},{"value":"0"}],[{"value":"8"},{"value":"5"}],[{"value":"8"},{"value":"0"}],[{"value":"9"},{"value":"19"}],[{"value":"9"},{"value":"0"}],[{"value":"10"},{"value":"36"}],[{"value":"10"},{"value":"0"}],[{"value":"11"},{"value":"95"}],[{"value":"11"},{"value":"0"}],[{"value":"12"},{"value":"80"}],[{"value":"12"},{"value":"0"}]],"columnNames":[{"name":"Mes","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados por Mes","index":1,"aggr":"sum"}],"rows":[["1","0"],["2","0"],["3","23"],["3","0"],["4","19"],["4","0"],["5","23"],["5","0"],["6","25"],["6","0"],["7","29"],["7","0"],["8","5"],["8","0"],["9","19"],["9","0"],["10","36"],["10","0"],["11","95"],["11","0"],["12","80"],["12","0"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:03-0300","dateFinished":"2016-12-14T12:58:04-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3162"},{"text":"// Sancionados por Mes y Año\n\nval baseSanctionedPerMonthAndYear = (\n    for { x <- 2011 to 2016\n          y <- 1 to 12\n          if x > 2011 || y >= 3 }\n          yield (x, y, List(y, x).mkString(\"-\"), 0))\n    .toDF(\"year\", \"month\", \"monthYear\", \"count\")\n\nval sanctionedPerMonthAndYear = sanctioned.groupBy($\"year\", $\"month\").count()\n    .select($\"year\", $\"month\", concat($\"month\", lit(\"-\"), $\"year\").as(\"monthYear\"), $\"count\")\n    .union(baseSanctionedPerMonthAndYear).dropDuplicates(\"monthYear\").orderBy($\"year\", $\"month\")\n    .select($\"monthYear\", $\"count\")\n\nprintZeppelinTable(sanctionedPerMonthAndYear, List(\"Mes y Año\", \"Cantidad de Proyecto Sancionados por Mes y Año\"), $\"monthYear\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes y Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes y Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562830_-469309505","id":"20161119-195537_1087168982","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes y Año\tCantidad de Proyecto Sancionados por Mes y Año\n3-2011\t1\n4-2011\t0\n5-2011\t0\n6-2011\t1\n7-2011\t1\n8-2011\t0\n9-2011\t0\n10-2011\t0\n11-2011\t0\n12-2011\t11\n1-2012\t0\n2-2012\t0\n3-2012\t14\n4-2012\t0\n5-2012\t4\n6-2012\t0\n7-2012\t1\n8-2012\t0\n9-2012\t4\n10-2012\t0\n11-2012\t39\n12-2012\t4\n1-2013\t0\n2-2013\t0\n3-2013\t3\n4-2013\t3\n5-2013\t5\n6-2013\t11\n7-2013\t12\n8-2013\t0\n9-2013\t8\n10-2013\t0\n11-2013\t18\n12-2013\t1\n1-2014\t0\n2-2014\t0\n3-2014\t1\n4-2014\t12\n5-2014\t2\n6-2014\t0\n7-2014\t2\n8-2014\t0\n9-2014\t5\n10-2014\t4\n11-2014\t3\n12-2014\t64\n1-2015\t0\n2-2015\t0\n3-2015\t4\n4-2015\t4\n5-2015\t4\n6-2015\t5\n7-2015\t7\n8-2015\t4\n9-2015\t1\n10-2015\t10\n11-2015\t16\n12-2015\t0\n1-2016\t0\n2-2016\t0\n3-2016\t0\n4-2016\t0\n5-2016\t8\n6-2016\t8\n7-2016\t6\n8-2016\t1\n9-2016\t1\n10-2016\t22\n11-2016\t19\n12-2016\t0\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados por Mes y Año","value":"3-2011"},{"key":"Cantidad de Proyecto Sancionados por Mes y Año","value":"1"}],[{"value":"4-2011"},{"value":"0"}],[{"value":"5-2011"},{"value":"0"}],[{"value":"6-2011"},{"value":"1"}],[{"value":"7-2011"},{"value":"1"}],[{"value":"8-2011"},{"value":"0"}],[{"value":"9-2011"},{"value":"0"}],[{"value":"10-2011"},{"value":"0"}],[{"value":"11-2011"},{"value":"0"}],[{"value":"12-2011"},{"value":"11"}],[{"value":"1-2012"},{"value":"0"}],[{"value":"2-2012"},{"value":"0"}],[{"value":"3-2012"},{"value":"14"}],[{"value":"4-2012"},{"value":"0"}],[{"value":"5-2012"},{"value":"4"}],[{"value":"6-2012"},{"value":"0"}],[{"value":"7-2012"},{"value":"1"}],[{"value":"8-2012"},{"value":"0"}],[{"value":"9-2012"},{"value":"4"}],[{"value":"10-2012"},{"value":"0"}],[{"value":"11-2012"},{"value":"39"}],[{"value":"12-2012"},{"value":"4"}],[{"value":"1-2013"},{"value":"0"}],[{"value":"2-2013"},{"value":"0"}],[{"value":"3-2013"},{"value":"3"}],[{"value":"4-2013"},{"value":"3"}],[{"value":"5-2013"},{"value":"5"}],[{"value":"6-2013"},{"value":"11"}],[{"value":"7-2013"},{"value":"12"}],[{"value":"8-2013"},{"value":"0"}],[{"value":"9-2013"},{"value":"8"}],[{"value":"10-2013"},{"value":"0"}],[{"value":"11-2013"},{"value":"18"}],[{"value":"12-2013"},{"value":"1"}],[{"value":"1-2014"},{"value":"0"}],[{"value":"2-2014"},{"value":"0"}],[{"value":"3-2014"},{"value":"1"}],[{"value":"4-2014"},{"value":"12"}],[{"value":"5-2014"},{"value":"2"}],[{"value":"6-2014"},{"value":"0"}],[{"value":"7-2014"},{"value":"2"}],[{"value":"8-2014"},{"value":"0"}],[{"value":"9-2014"},{"value":"5"}],[{"value":"10-2014"},{"value":"4"}],[{"value":"11-2014"},{"value":"3"}],[{"value":"12-2014"},{"value":"64"}],[{"value":"1-2015"},{"value":"0"}],[{"value":"2-2015"},{"value":"0"}],[{"value":"3-2015"},{"value":"4"}],[{"value":"4-2015"},{"value":"4"}],[{"value":"5-2015"},{"value":"4"}],[{"value":"6-2015"},{"value":"5"}],[{"value":"7-2015"},{"value":"7"}],[{"value":"8-2015"},{"value":"4"}],[{"value":"9-2015"},{"value":"1"}],[{"value":"10-2015"},{"value":"10"}],[{"value":"11-2015"},{"value":"16"}],[{"value":"12-2015"},{"value":"0"}],[{"value":"1-2016"},{"value":"0"}],[{"value":"2-2016"},{"value":"0"}],[{"value":"3-2016"},{"value":"0"}],[{"value":"4-2016"},{"value":"0"}],[{"value":"5-2016"},{"value":"8"}],[{"value":"6-2016"},{"value":"8"}],[{"value":"7-2016"},{"value":"6"}],[{"value":"8-2016"},{"value":"1"}],[{"value":"9-2016"},{"value":"1"}],[{"value":"10-2016"},{"value":"22"}],[{"value":"11-2016"},{"value":"19"}],[{"value":"12-2016"},{"value":"0"}]],"columnNames":[{"name":"Mes y Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}],"rows":[["3-2011","1"],["4-2011","0"],["5-2011","0"],["6-2011","1"],["7-2011","1"],["8-2011","0"],["9-2011","0"],["10-2011","0"],["11-2011","0"],["12-2011","11"],["1-2012","0"],["2-2012","0"],["3-2012","14"],["4-2012","0"],["5-2012","4"],["6-2012","0"],["7-2012","1"],["8-2012","0"],["9-2012","4"],["10-2012","0"],["11-2012","39"],["12-2012","4"],["1-2013","0"],["2-2013","0"],["3-2013","3"],["4-2013","3"],["5-2013","5"],["6-2013","11"],["7-2013","12"],["8-2013","0"],["9-2013","8"],["10-2013","0"],["11-2013","18"],["12-2013","1"],["1-2014","0"],["2-2014","0"],["3-2014","1"],["4-2014","12"],["5-2014","2"],["6-2014","0"],["7-2014","2"],["8-2014","0"],["9-2014","5"],["10-2014","4"],["11-2014","3"],["12-2014","64"],["1-2015","0"],["2-2015","0"],["3-2015","4"],["4-2015","4"],["5-2015","4"],["6-2015","5"],["7-2015","7"],["8-2015","4"],["9-2015","1"],["10-2015","10"],["11-2015","16"],["12-2015","0"],["1-2016","0"],["2-2016","0"],["3-2016","0"],["4-2016","0"],["5-2016","8"],["6-2016","8"],["7-2016","6"],["8-2016","1"],["9-2016","1"],["10-2016","22"],["11-2016","19"],["12-2016","0"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:04-0300","dateFinished":"2016-12-14T12:58:06-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3163"},{"text":"val halfSanctioned = results.filter($\"result\" === \"MEDIA SANCION\").select($\"id\", $\"result\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562832_-459306034","id":"20161213-163143_1566901836","result":{"code":"SUCCESS","type":"TEXT","msg":"\nhalfSanctioned: org.apache.spark.sql.DataFrame = [id: string, result: string ... 2 more fields]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:05-0300","dateFinished":"2016-12-14T12:58:07-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3164"},{"text":"// Medias Sanciones por Año\nval halfSanctionedPerYear = halfSanctioned.groupBy($\"year\").count().orderBy($\"year\")\n\nprintZeppelinTable(halfSanctionedPerYear, List(\"Año\", \"Cantidad de Proyectos con Media Sancion por Año\"), $\"year\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562832_-459306034","id":"20161213-163145_228033509","result":{"code":"SUCCESS","type":"TABLE","msg":"Año\tCantidad de Proyectos con Media Sancion por Año\n2011\t31\n2012\t225\n2013\t110\n2014\t189\n2015\t171\n2016\t47\n","comment":"","msgTable":[[{"key":"Cantidad de Proyectos con Media Sancion por Año","value":"2011"},{"key":"Cantidad de Proyectos con Media Sancion por Año","value":"31"}],[{"value":"2012"},{"value":"225"}],[{"value":"2013"},{"value":"110"}],[{"value":"2014"},{"value":"189"}],[{"value":"2015"},{"value":"171"}],[{"value":"2016"},{"value":"47"}]],"columnNames":[{"name":"Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyectos con Media Sancion por Año","index":1,"aggr":"sum"}],"rows":[["2011","31"],["2012","225"],["2013","110"],["2014","189"],["2015","171"],["2016","47"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:07-0300","dateFinished":"2016-12-14T12:58:07-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3165"},{"text":"// Medias Sanciones por mes\n\nval baseHalfSanctionedPerMonth = (for { m <- 1 to 12 } yield (m, 0)).toDF(\"month\", \"count\")\n\nval halfSanctionedPerMonth = halfSanctioned.groupBy($\"month\").count()\n    .union(baseHalfSanctionedPerMonth).orderBy($\"month\")\n    \nprintZeppelinTable(halfSanctionedPerMonth, List(\"Mes\", \"Cantidad de Proyectos con Media Sancion por Mes\"), $\"month\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562832_-459306034","id":"20161213-163146_605664572","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes\tCantidad de Proyectos con Media Sancion por Mes\n1\t0\n2\t0\n3\t3\n3\t0\n4\t32\n4\t0\n5\t10\n5\t0\n6\t69\n6\t0\n7\t33\n7\t0\n8\t50\n8\t0\n9\t57\n9\t0\n10\t57\n10\t0\n11\t391\n11\t0\n12\t71\n12\t0\n","comment":"","msgTable":[[{"key":"Cantidad de Proyectos con Media Sancion por Mes","value":"1"},{"key":"Cantidad de Proyectos con Media Sancion por Mes","value":"0"}],[{"value":"2"},{"value":"0"}],[{"value":"3"},{"value":"3"}],[{"value":"3"},{"value":"0"}],[{"value":"4"},{"value":"32"}],[{"value":"4"},{"value":"0"}],[{"value":"5"},{"value":"10"}],[{"value":"5"},{"value":"0"}],[{"value":"6"},{"value":"69"}],[{"value":"6"},{"value":"0"}],[{"value":"7"},{"value":"33"}],[{"value":"7"},{"value":"0"}],[{"value":"8"},{"value":"50"}],[{"value":"8"},{"value":"0"}],[{"value":"9"},{"value":"57"}],[{"value":"9"},{"value":"0"}],[{"value":"10"},{"value":"57"}],[{"value":"10"},{"value":"0"}],[{"value":"11"},{"value":"391"}],[{"value":"11"},{"value":"0"}],[{"value":"12"},{"value":"71"}],[{"value":"12"},{"value":"0"}]],"columnNames":[{"name":"Mes","index":0,"aggr":"sum"},{"name":"Cantidad de Proyectos con Media Sancion por Mes","index":1,"aggr":"sum"}],"rows":[["1","0"],["2","0"],["3","3"],["3","0"],["4","32"],["4","0"],["5","10"],["5","0"],["6","69"],["6","0"],["7","33"],["7","0"],["8","50"],["8","0"],["9","57"],["9","0"],["10","57"],["10","0"],["11","391"],["11","0"],["12","71"],["12","0"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T13:54:10-0300","dateFinished":"2016-12-14T13:54:11-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3166","focus":true},{"text":"// Medias Sanciones por Mes y Año\n\nval baseHalfSanctionedPerMonthAndYear = (\n    for { x <- 2011 to 2016\n          y <- 1 to 12\n          if x > 2011 || y >= 3 }\n          yield (x, y, List(y, x).mkString(\"-\"), 0))\n    .toDF(\"year\", \"month\", \"monthYear\", \"count\")\n\nval halfSanctionedPerMonthAndYear = halfSanctioned.groupBy($\"year\", $\"month\").count()\n    .select($\"year\", $\"month\", concat($\"month\", lit(\"-\"), $\"year\").as(\"monthYear\"), $\"count\")\n    .union(baseHalfSanctionedPerMonthAndYear).dropDuplicates(\"monthYear\").orderBy($\"year\", $\"month\")\n    .select($\"monthYear\", $\"count\")\n\nprintZeppelinTable(halfSanctionedPerMonthAndYear, List(\"Mes y Año\", \"Cantidad de Proyecto Sancionados por Mes y Año\"), $\"monthYear\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Mes y Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Mes y Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481728125927_1219553155","id":"20161214-120845_669537946","result":{"code":"SUCCESS","type":"TABLE","msg":"Mes y Año\tCantidad de Proyecto Sancionados por Mes y Año\n3-2011\t1\n4-2011\t0\n5-2011\t1\n6-2011\t1\n7-2011\t0\n8-2011\t0\n9-2011\t3\n10-2011\t0\n11-2011\t14\n12-2011\t11\n1-2012\t0\n2-2012\t0\n3-2012\t0\n4-2012\t15\n5-2012\t5\n6-2012\t27\n7-2012\t0\n8-2012\t13\n9-2012\t0\n10-2012\t36\n11-2012\t129\n12-2012\t0\n1-2013\t0\n2-2013\t0\n3-2013\t0\n4-2013\t11\n5-2013\t0\n6-2013\t15\n7-2013\t12\n8-2013\t0\n9-2013\t17\n10-2013\t0\n11-2013\t54\n12-2013\t1\n1-2014\t0\n2-2014\t0\n3-2014\t0\n4-2014\t0\n5-2014\t0\n6-2014\t0\n7-2014\t10\n8-2014\t19\n9-2014\t0\n10-2014\t9\n11-2014\t92\n12-2014\t59\n1-2015\t0\n2-2015\t0\n3-2015\t2\n4-2015\t6\n5-2015\t1\n6-2015\t16\n7-2015\t11\n8-2015\t18\n9-2015\t14\n10-2015\t6\n11-2015\t97\n12-2015\t0\n1-2016\t0\n2-2016\t0\n3-2016\t0\n4-2016\t0\n5-2016\t3\n6-2016\t10\n7-2016\t0\n8-2016\t0\n9-2016\t23\n10-2016\t6\n11-2016\t5\n12-2016\t0\n","comment":"","msgTable":[[{"key":"Cantidad de Proyecto Sancionados por Mes y Año","value":"3-2011"},{"key":"Cantidad de Proyecto Sancionados por Mes y Año","value":"1"}],[{"value":"4-2011"},{"value":"0"}],[{"value":"5-2011"},{"value":"1"}],[{"value":"6-2011"},{"value":"1"}],[{"value":"7-2011"},{"value":"0"}],[{"value":"8-2011"},{"value":"0"}],[{"value":"9-2011"},{"value":"3"}],[{"value":"10-2011"},{"value":"0"}],[{"value":"11-2011"},{"value":"14"}],[{"value":"12-2011"},{"value":"11"}],[{"value":"1-2012"},{"value":"0"}],[{"value":"2-2012"},{"value":"0"}],[{"value":"3-2012"},{"value":"0"}],[{"value":"4-2012"},{"value":"15"}],[{"value":"5-2012"},{"value":"5"}],[{"value":"6-2012"},{"value":"27"}],[{"value":"7-2012"},{"value":"0"}],[{"value":"8-2012"},{"value":"13"}],[{"value":"9-2012"},{"value":"0"}],[{"value":"10-2012"},{"value":"36"}],[{"value":"11-2012"},{"value":"129"}],[{"value":"12-2012"},{"value":"0"}],[{"value":"1-2013"},{"value":"0"}],[{"value":"2-2013"},{"value":"0"}],[{"value":"3-2013"},{"value":"0"}],[{"value":"4-2013"},{"value":"11"}],[{"value":"5-2013"},{"value":"0"}],[{"value":"6-2013"},{"value":"15"}],[{"value":"7-2013"},{"value":"12"}],[{"value":"8-2013"},{"value":"0"}],[{"value":"9-2013"},{"value":"17"}],[{"value":"10-2013"},{"value":"0"}],[{"value":"11-2013"},{"value":"54"}],[{"value":"12-2013"},{"value":"1"}],[{"value":"1-2014"},{"value":"0"}],[{"value":"2-2014"},{"value":"0"}],[{"value":"3-2014"},{"value":"0"}],[{"value":"4-2014"},{"value":"0"}],[{"value":"5-2014"},{"value":"0"}],[{"value":"6-2014"},{"value":"0"}],[{"value":"7-2014"},{"value":"10"}],[{"value":"8-2014"},{"value":"19"}],[{"value":"9-2014"},{"value":"0"}],[{"value":"10-2014"},{"value":"9"}],[{"value":"11-2014"},{"value":"92"}],[{"value":"12-2014"},{"value":"59"}],[{"value":"1-2015"},{"value":"0"}],[{"value":"2-2015"},{"value":"0"}],[{"value":"3-2015"},{"value":"2"}],[{"value":"4-2015"},{"value":"6"}],[{"value":"5-2015"},{"value":"1"}],[{"value":"6-2015"},{"value":"16"}],[{"value":"7-2015"},{"value":"11"}],[{"value":"8-2015"},{"value":"18"}],[{"value":"9-2015"},{"value":"14"}],[{"value":"10-2015"},{"value":"6"}],[{"value":"11-2015"},{"value":"97"}],[{"value":"12-2015"},{"value":"0"}],[{"value":"1-2016"},{"value":"0"}],[{"value":"2-2016"},{"value":"0"}],[{"value":"3-2016"},{"value":"0"}],[{"value":"4-2016"},{"value":"0"}],[{"value":"5-2016"},{"value":"3"}],[{"value":"6-2016"},{"value":"10"}],[{"value":"7-2016"},{"value":"0"}],[{"value":"8-2016"},{"value":"0"}],[{"value":"9-2016"},{"value":"23"}],[{"value":"10-2016"},{"value":"6"}],[{"value":"11-2016"},{"value":"5"}],[{"value":"12-2016"},{"value":"0"}]],"columnNames":[{"name":"Mes y Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyecto Sancionados por Mes y Año","index":1,"aggr":"sum"}],"rows":[["3-2011","1"],["4-2011","0"],["5-2011","1"],["6-2011","1"],["7-2011","0"],["8-2011","0"],["9-2011","3"],["10-2011","0"],["11-2011","14"],["12-2011","11"],["1-2012","0"],["2-2012","0"],["3-2012","0"],["4-2012","15"],["5-2012","5"],["6-2012","27"],["7-2012","0"],["8-2012","13"],["9-2012","0"],["10-2012","36"],["11-2012","129"],["12-2012","0"],["1-2013","0"],["2-2013","0"],["3-2013","0"],["4-2013","11"],["5-2013","0"],["6-2013","15"],["7-2013","12"],["8-2013","0"],["9-2013","17"],["10-2013","0"],["11-2013","54"],["12-2013","1"],["1-2014","0"],["2-2014","0"],["3-2014","0"],["4-2014","0"],["5-2014","0"],["6-2014","0"],["7-2014","10"],["8-2014","19"],["9-2014","0"],["10-2014","9"],["11-2014","92"],["12-2014","59"],["1-2015","0"],["2-2015","0"],["3-2015","2"],["4-2015","6"],["5-2015","1"],["6-2015","16"],["7-2015","11"],["8-2015","18"],["9-2015","14"],["10-2015","6"],["11-2015","97"],["12-2015","0"],["1-2016","0"],["2-2016","0"],["3-2016","0"],["4-2016","0"],["5-2016","3"],["6-2016","10"],["7-2016","0"],["8-2016","0"],["9-2016","23"],["10-2016","6"],["11-2016","5"],["12-2016","0"]]},"dateCreated":"2016-12-14T12:08:45-0300","dateStarted":"2016-12-14T12:58:08-0300","dateFinished":"2016-12-14T12:58:10-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3167","focus":true},{"text":"val retired = results.filter($\"result\" === \"RETIRADO\").select($\"id\", $\"result\", month($\"date\").as(\"month\"), year($\"date\").as(\"year\"))","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562833_-459690783","id":"20161119-202954_202626127","result":{"code":"SUCCESS","type":"TEXT","msg":"\nretired: org.apache.spark.sql.DataFrame = [id: string, result: string ... 2 more fields]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T13:54:35-0300","dateFinished":"2016-12-14T13:54:35-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3168","focus":true},{"text":"// Retirados por Año\nval retiredPerYear = retired.groupBy($\"year\").count().orderBy($\"year\")\n\nprintZeppelinTable(retiredPerYear, List(\"Año\", \"Cantidad de Proyectos Retirados por Año\"), $\"year\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"Año","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyectos Retirados por Año","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Año","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyectos Retirados por Año","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481728537434_-33173939","id":"20161214-121537_1529600006","result":{"code":"SUCCESS","type":"TABLE","msg":"Año\tCantidad de Proyectos Retirados por Año\n2011\t5\n2012\t13\n2013\t4\n","comment":"","msgTable":[[{"key":"Cantidad de Proyectos Retirados por Año","value":"2011"},{"key":"Cantidad de Proyectos Retirados por Año","value":"5"}],[{"value":"2012"},{"value":"13"}],[{"value":"2013"},{"value":"4"}]],"columnNames":[{"name":"Año","index":0,"aggr":"sum"},{"name":"Cantidad de Proyectos Retirados por Año","index":1,"aggr":"sum"}],"rows":[["2011","5"],["2012","13"],["2013","4"]]},"dateCreated":"2016-12-14T12:15:37-0300","dateStarted":"2016-12-14T13:59:30-0300","dateFinished":"2016-12-14T13:59:31-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3169","focus":true},{"text":"val amountOfProjects = Seq((\"PRESENTADO\", laws.count())).toDF()\n\nval grouped = results.groupBy(\"result\").agg(countDistinct($\"id\").as(\"amount\"))\nval allGrouped = grouped.union(amountOfProjects).toDF()\n\nprintZeppelinTable(allGrouped, List(\"Categoria\", \"Cantidad\"), $\"result\", $\"amount\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Categoria","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Categoria","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562833_-459690783","id":"20161119-221416_434910484","result":{"code":"SUCCESS","type":"TABLE","msg":"Categoria\tCantidad\nSANCIONADO\t354\nAPROBADO\t2\nRETIRADO\t22\nMEDIA SANCION\t714\nPRESENTADO\t12941\n","comment":"","msgTable":[[{"key":"Cantidad","value":"SANCIONADO"},{"key":"Cantidad","value":"354"}],[{"value":"APROBADO"},{"value":"2"}],[{"value":"RETIRADO"},{"value":"22"}],[{"value":"MEDIA SANCION"},{"value":"714"}],[{"value":"PRESENTADO"},{"value":"12941"}]],"columnNames":[{"name":"Categoria","index":0,"aggr":"sum"},{"name":"Cantidad","index":1,"aggr":"sum"}],"rows":[["SANCIONADO","354"],["APROBADO","2"],["RETIRADO","22"],["MEDIA SANCION","714"],["PRESENTADO","12941"]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:11-0300","dateFinished":"2016-12-14T12:58:12-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3170"},{"text":"// Proyectos totales por partido.\nval signersByParty = signers.groupBy($\"party\").agg(countDistinct($\"id\").as(\"count\")).orderBy(desc(\"count\"))\n\nprintZeppelinTable(signersByParty, List(\"Partido\", \"Cantidad de Proyectos Presentados\"), $\"party\", $\"count\")","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Partido","index":0,"aggr":"sum"}],"values":[{"name":"Cantidad de Proyectos Presentados","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Partido","index":0,"aggr":"sum"},"yAxis":{"name":"Cantidad de Proyectos Presentados","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562834_-458536536","id":"20161121-180050_1746410658","result":{"code":"SUCCESS","type":"TABLE","msg":"Partido\tCantidad de Proyectos Presentados\nFRENTE PARA LA VICTORIA - PJ\t3940\nUCR\t2608\nGEN\t1007\nUNION PRO\t985\nPARTIDO SOCIALISTA\t788\nLIBRES DEL SUR\t593\nMOV POP NEUQUINO\t572\nFRENTE PERONISTA\t541\nPRO\t516\nCOMPROMISO FEDERAL\t488\nUNIDAD POPULAR\t446\nFRENTE RENOVADOR\t400\nUNIR\t397\nFEDERAL UNIDOS POR UNA NUEVA ARGENTINA\t372\nFRENTE CIVICO - CORDOBA\t330\nCOALICION CIVICA\t323\nCOALICION CIVICA - ARI\t298\nUDESO SALTA\t266\nJUSTICIALISTA\t213\nTRABAJO Y DIGNIDAD\t205\nPARTIDO JUSTICIALISTA LA PAMPA\t201\nFRENTE PARA LA VICTORIA - PARTIDO BLOQUISTA\t200\nPERONISMO FEDERAL\t198\nCOALICION CIVICA ARI - UNEN\t185\nPROYECTO SUR - UNEN\t168\nMOVIMIENTO PROYECTO SUR\t151\nFRENTE CIVICO POR SANTIAGO\t149\nFRENTE CIVICO Y SOCIAL DE CATAMARCA\t145\nUNION POR TODOS\t144\nUNIDOS POR UNA NUEVA ARGENTINA\t116\nUNION CELES...","comment":"","msgTable":[[{"key":"Cantidad de Proyectos Presentados","value":"FRENTE PARA LA VICTORIA - PJ"},{"key":"Cantidad de Proyectos Presentados","value":"3940"}],[{"value":"UCR"},{"value":"2608"}],[{"value":"GEN"},{"value":"1007"}],[{"value":"UNION PRO"},{"value":"985"}],[{"value":"PARTIDO SOCIALISTA"},{"value":"788"}],[{"value":"LIBRES DEL SUR"},{"value":"593"}],[{"value":"MOV POP NEUQUINO"},{"value":"572"}],[{"value":"FRENTE PERONISTA"},{"value":"541"}],[{"value":"PRO"},{"value":"516"}],[{"value":"COMPROMISO FEDERAL"},{"value":"488"}],[{"value":"UNIDAD POPULAR"},{"value":"446"}],[{"value":"FRENTE RENOVADOR"},{"value":"400"}],[{"value":"UNIR"},{"value":"397"}],[{"value":"FEDERAL UNIDOS POR UNA NUEVA ARGENTINA"},{"value":"372"}],[{"value":"FRENTE CIVICO - CORDOBA"},{"value":"330"}],[{"value":"COALICION CIVICA"},{"value":"323"}],[{"value":"COALICION CIVICA - ARI"},{"value":"298"}],[{"value":"UDESO SALTA"},{"value":"266"}],[{"value":"JUSTICIALISTA"},{"value":"213"}],[{"value":"TRABAJO Y DIGNIDAD"},{"value":"205"}],[{"value":"PARTIDO JUSTICIALISTA LA PAMPA"},{"value":"201"}],[{"value":"FRENTE PARA LA VICTORIA - PARTIDO BLOQUISTA"},{"value":"200"}],[{"value":"PERONISMO FEDERAL"},{"value":"198"}],[{"value":"COALICION CIVICA ARI - UNEN"},{"value":"185"}],[{"value":"PROYECTO SUR - UNEN"},{"value":"168"}],[{"value":"MOVIMIENTO PROYECTO SUR"},{"value":"151"}],[{"value":"FRENTE CIVICO POR SANTIAGO"},{"value":"149"}],[{"value":"FRENTE CIVICO Y SOCIAL DE CATAMARCA"},{"value":"145"}],[{"value":"UNION POR TODOS"},{"value":"144"}],[{"value":"UNIDOS POR UNA NUEVA ARGENTINA"},{"value":"116"}],[{"value":"UNION CELES..."}]],"columnNames":[{"name":"Partido","index":0,"aggr":"sum"},{"name":"Cantidad de Proyectos Presentados","index":1,"aggr":"sum"}],"rows":[["FRENTE PARA LA VICTORIA - PJ","3940"],["UCR","2608"],["GEN","1007"],["UNION PRO","985"],["PARTIDO SOCIALISTA","788"],["LIBRES DEL SUR","593"],["MOV POP NEUQUINO","572"],["FRENTE PERONISTA","541"],["PRO","516"],["COMPROMISO FEDERAL","488"],["UNIDAD POPULAR","446"],["FRENTE RENOVADOR","400"],["UNIR","397"],["FEDERAL UNIDOS POR UNA NUEVA ARGENTINA","372"],["FRENTE CIVICO - CORDOBA","330"],["COALICION CIVICA","323"],["COALICION CIVICA - ARI","298"],["UDESO SALTA","266"],["JUSTICIALISTA","213"],["TRABAJO Y DIGNIDAD","205"],["PARTIDO JUSTICIALISTA LA PAMPA","201"],["FRENTE PARA LA VICTORIA - PARTIDO BLOQUISTA","200"],["PERONISMO FEDERAL","198"],["COALICION CIVICA ARI - UNEN","185"],["PROYECTO SUR - UNEN","168"],["MOVIMIENTO PROYECTO SUR","151"],["FRENTE CIVICO POR SANTIAGO","149"],["FRENTE CIVICO Y SOCIAL DE CATAMARCA","145"],["UNION POR TODOS","144"],["UNIDOS POR UNA NUEVA ARGENTINA","116"],["UNION CELES..."]]},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:11-0300","dateFinished":"2016-12-14T12:58:14-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3171"},{"text":"def getAmountOfMonths: Long => Long = _ / 30\n\n\n//Tiempo hasta conseguir media sanción\nval timeHalfSanction = results.select($\"id\", $\"result\", $\"date\".alias(\"resultdate\")).join(laws, \"id\").select($\"id\",$\"date\".alias(\"presentationdate\"),$\"result\",$\"resultdate\").withColumn(\"Diferencia (Días)\", datediff($\"resultdate\", $\"presentationdate\")).filter($\"result\" === \"MEDIA SANCION\").withColumn(\"Diferencia (Meses)\", udf(getAmountOfMonths).apply($\"Diferencia (Días)\"))\n\n\n//Tiempo hasta conseguir sanción completa\nval timeSanction = results.select($\"id\", $\"result\", $\"date\".alias(\"resultdate\")).join(laws, \"id\").select($\"id\",$\"date\".alias(\"presentationdate\"),$\"result\",$\"resultdate\").withColumn(\"Diferencia (Días)\", datediff($\"resultdate\", $\"presentationdate\")).filter($\"result\" === \"SANCIONADO\").withColumn(\"Diferencia (Meses)\", udf(getAmountOfMonths).apply($\"Diferencia (Días)\"))","dateUpdated":"2016-12-14T14:29:53-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562835_-458921285","id":"20161123-161550_1595936538","result":{"code":"SUCCESS","type":"TEXT","msg":"\ngetAmountOfMonths: Long => Long\n\ntimeHalfSanction: org.apache.spark.sql.DataFrame = [id: string, presentationdate: date ... 4 more fields]\n\ntimeSanction: org.apache.spark.sql.DataFrame = [id: string, presentationdate: date ... 4 more fields]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T14:20:22-0300","dateFinished":"2016-12-14T14:20:22-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3172","focus":true},{"text":"val histogramMediaSancion = timeMediaSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\nhistogramMediaSancion.show(100)","dateUpdated":"2016-12-14T14:29:54-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562835_-458921285","id":"20161123-163609_1230029729","result":{"code":"ERROR","type":"TEXT","msg":"\n\n\n<console>:61: error: not found: value timeMediaSancion\n       val histogramMediaSancion = timeMediaSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\n                                   ^\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:14-0300","dateFinished":"2016-12-14T12:58:15-0300","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3173"},{"text":"val histogramSancion = timeSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\nhistogramSancion.show(100)","dateUpdated":"2016-12-14T14:29:54-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562835_-458921285","id":"20161123-165928_1330376200","result":{"code":"ERROR","type":"TEXT","msg":"\n\n\n<console>:61: error: not found: value timeSancion\n       val histogramSancion = timeSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\n                              ^\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:15-0300","dateFinished":"2016-12-14T12:58:15-0300","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3174"},{"text":"val signersPerProject = signers.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"total_signers\"))\n\n","dateUpdated":"2016-12-14T14:29:54-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562835_-458921285","id":"20161123-161130_893023380","result":{"code":"SUCCESS","type":"TEXT","msg":"\nsignersPerProject: org.apache.spark.sql.DataFrame = [id: string, total_signers: bigint]\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:15-0300","dateFinished":"2016-12-14T12:58:15-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3175"},{"text":"val projectsPerDeputy = signers.groupBy(\"congressman\")\n\n//Top 20 Cantidad de proyectos presentados por diputado\nsigners.groupBy(\"congressman\").agg(countDistinct(\"id\").as(\"#Proyectos Presentados\")).sort(desc(\"#Proyectos Presentados\")).show(20)\n\n//Bottom 20 Cantidad de proyectos presentados por diputado\nsigners.groupBy(\"congressman\").agg(countDistinct(\"id\").as(\"#Proyectos Presentados\")).sort(asc(\"#Proyectos Presentados\")).show(20)\n\n//Cantidad de partidos firmantes por proyecto\nval partiesPerProject = signers.groupBy(\"id\").agg(countDistinct(\"party\").as(\"#Partidos por Proyecto\"))\n\n//Top 20\npartidosPorProyecto.sort(desc(\"#Partidos por Proyecto\")).show()\n\npartidosPorProyecto.select(avg(\"#Partidos por Proyecto\").as(\"Promedio de partidos firmantes por proyecto\")).show()\n\nval rowMaxOverTwo = partidosPorProyecto.count.toFloat / 2\npartidosPorProyecto.select($\"#Partidos por Proyecto\", row_number.over(Window.orderBy($\"#Partidos por Proyecto\")).as(\"rowIndex\"))\n    .select($\"#Partidos por Proyecto\", $\"rowIndex\", ($\"rowIndex\" - rowMaxOverTwo).as(\"filterRow\")).where($\"filterRow\" >= 0 && $\"filterRow\" <= 1)\n    .agg(avg($\"#Partidos por Proyecto\").as(\"Mediana de Partidos por Proyecto\")).show(false)\n","dateUpdated":"2016-12-14T14:29:54-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562835_-458921285","id":"20161123-184222_1304745763","result":{"code":"ERROR","type":"TEXT","msg":"\nprojectsPerDeputy: org.apache.spark.sql.RelationalGroupedDataset = org.apache.spark.sql.RelationalGroupedDataset@3ecf1b5\n+--------------------+----------------------+\n|         congressman|#Proyectos Presentados|\n+--------------------+----------------------+\n|RECALDE, HECTOR P...|                   630|\n|BIANCHI, IVANA MARIA|                   573|\n|DONDA PEREZ, VICT...|                   552|\n|ASSEFF, ALBERTO E...|                   474|\n|DUCLOS, OMAR ARNALDO|                   410|\n|LINARES, MARIA VI...|                   392|\n|  BULLRICH, PATRICIA|                   374|\n|COMELLI, ALICIA M...|                   371|\n|    PINEDO, FEDERICO|                   303|\n|CARRIO, ELISA MAR...|                   298|\n|MILMAN, GERARDO F...|                   288|\n|PERALTA, FABIAN F...|                   285|\n|MARTINEZ, JULIO C...|                   279|\n|STOLBIZER, MARGAR...|                   274|\n|SCHMIDT LIERMANN,...|                   269|\n|CICILIANI, ALICIA...|                   268|\n|BIELLA CALVET, BE...|                   267|\n|CONTI, DIANA BEATRIZ|                   263|\n|ARGUMEDO, ALCIRA ...|                   256|\n|    PAIS, JUAN MARIO|                   253|\n+--------------------+----------------------+\nonly showing top 20 rows\n\n+--------------------+----------------------+\n|         congressman|#Proyectos Presentados|\n+--------------------+----------------------+\n|       MONZO, EMILIO|                     1|\n| LORGES, JUAN CARLOS|                     1|\n|BETTANIN, JUAN CA...|                     1|\n|      SOSA , SOLEDAD|                     1|\n|SATRAGNO, LIDIA ELSA|                     1|\n|BELLOCQ, GERARDO ...|                     1|\n|GOMEZ, MAURICIO R...|                     2|\n|ROSSI, ALEJANDRO ...|                     2|\n|ALEGRE, OSCAR GIL...|                     2|\n|KORENFELD, BEATRI...|                     2|\n|MONTOYA, JORGE LU...|                     2|\n|ASEF, DANIEL EDGARDO|                     2|\n|DEL CAMPILLO, HEC...|                     2|\n|LEGUIZAMON, MARIA...|                     2|\n|FIOL, PAULINA ESTHER|                     3|\n|PEREYRA, GUILLERM...|                     3|\n|DUTTO, GUSTAVO AL...|                     3|\n|FELLNER, EDUARDO ...|                     3|\n| DIAZ, SUSANA ELADIA|                     3|\n|ALFARO, GERMAN EN...|                     3|\n+--------------------+----------------------+\nonly showing top 20 rows\n\n\npartiesPerProject: org.apache.spark.sql.DataFrame = [id: string, #Partidos por Proyecto: bigint]\n\n\n\n<console>:62: error: not found: value partidosPorProyecto\n       partidosPorProyecto.sort(desc(\"#Partidos por Proyecto\")).show()\n       ^\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:15-0300","dateFinished":"2016-12-14T12:58:20-0300","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3176"},{"text":"val diputadosPorProyecto = firmantes.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"#Diputados por Proyecto\"))\n\ndiputadosPorProyecto.select(avg(\"#Diputados por Proyecto\").as(\"Promedio de diputados firmantes por proyecto\")).show()\n\nval rowMaxOverTwo2 = diputadosPorProyecto.count.toFloat / 2\ndiputadosPorProyecto.select($\"#Diputados por Proyecto\", row_number.over(Window.orderBy($\"#Diputados por Proyecto\")).as(\"rowIndex\"))\n    .select($\"#Diputados por Proyecto\", $\"rowIndex\", ($\"rowIndex\" - rowMaxOverTwo2).as(\"filterRow\")).where($\"filterRow\" >= 0 && $\"filterRow\" <= 1)\n    .agg(avg($\"#Diputados por Proyecto\").as(\"Mediana de Diputados por Proyecto\")).show(false)","dateUpdated":"2016-12-14T14:29:54-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562835_-458921285","id":"20161123-184322_700111182","result":{"code":"ERROR","type":"TEXT","msg":"\n\n\n<console>:61: error: not found: value firmantes\n       val diputadosPorProyecto = firmantes.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"#Diputados por Proyecto\"))\n                                  ^\n"},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:15-0300","dateFinished":"2016-12-14T12:58:20-0300","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3177"},{"text":"","dateUpdated":"2016-12-14T14:29:54-0300","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481727562836_-460845029","id":"20161123-225914_761807549","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-12-14T11:59:22-0300","dateStarted":"2016-12-14T12:58:20-0300","dateFinished":"2016-12-14T12:58:20-0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3178"}],"name":"HCDN: Estadísticas Generales","id":"2C55PSK5F","angularObjects":{"2C35MP9KW:shared_process":[],"2C42BMA7S:shared_process":[],"2C5NSKBUZ:shared_process":[],"2C6NBQ97R:shared_process":[],"2C5AG626G:shared_process":[],"2C53SXPS3:shared_process":[],"2C5FVY3ZW:shared_process":[],"2C36G132V:shared_process":[],"2C5UFVU2U:shared_process":[],"2C4C7ZS5G:shared_process":[],"2C5CHMN2G:shared_process":[],"2C31BTMG8:shared_process":[],"2C5MEY31D:shared_process":[],"2C5R54D4B:shared_process":[],"2C65MM912:shared_process":[],"2C3TZ5DX8:shared_process":[],"2C462R32G:shared_process":[],"2C5XQ7T4X:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}