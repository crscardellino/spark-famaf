{"paragraphs":[{"text":"import java.sql.Timestamp\n\nimport org.apache.spark.sql.{DataFrame, Dataset, SparkSession}\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.rdd.RDD\n\nval spark = SparkSession\n  .builder()\n  .appName(\"Spark app\")\n  .config(\"spark.some.config.option\", \"algun-valor\")\n  .getOrCreate()\n\n// Para conversion implicita, por ej entre RDD a DataFrames\nimport spark.implicits._","dateUpdated":"2016-11-23T18:03:32+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479578922625_944396309","id":"20161119-190842_1402150266","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport java.sql.Timestamp\n\nimport org.apache.spark.sql.{DataFrame, Dataset, SparkSession}\n\nimport org.apache.spark.sql.expressions.Window\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.rdd.RDD\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@439c67e7\n\nimport spark.implicits._\n"},"dateCreated":"2016-11-19T07:08:42+0100","dateStarted":"2016-11-23T18:03:32+0100","dateFinished":"2016-11-23T18:03:33+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:171","focus":true},{"text":"//Lectura de parquets, cambiar por el directorio que sea necesario.\n\nval leyes = spark.read.parquet(\"/home/lbiedma/Documents/estudiar/bigdata/pruebas/laws.parquet\")\nval resultados = spark.read.parquet(\"/home/lbiedma/Documents/estudiar/bigdata/pruebas/results.parquet\")\nval firmantes = spark.read.parquet(\"/home/lbiedma/Documents/estudiar/bigdata/pruebas/signers.parquet\")\nval comisionesDiputados = spark.read.parquet(\"/home/lbiedma/Documents/estudiar/bigdata/pruebas/deputyCommissions.parquet\")\nval ComisionesSenado = spark.read.parquet(\"/home/lbiedma/Documents/estudiar/bigdata/pruebas/senateCommissions.parquet\")\n","dateUpdated":"2016-11-23T15:45:23+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479580233624_-1317476245","id":"20161119-193033_1078033333","result":{"code":"SUCCESS","type":"TEXT","msg":"\nleyes: org.apache.spark.sql.DataFrame = [id: string, date: string ... 2 more fields]\n\nresultados: org.apache.spark.sql.DataFrame = [id: string, chamber: string ... 2 more fields]\n\nfirmantes: org.apache.spark.sql.DataFrame = [id: string, congressman: string ... 2 more fields]\n\ncomisionesDiputados: org.apache.spark.sql.DataFrame = [id: string, commission: string]\n\nComisionesSenado: org.apache.spark.sql.DataFrame = [id: string, commission: string]\n"},"dateCreated":"2016-11-19T07:30:33+0100","dateStarted":"2016-11-23T15:45:23+0100","dateFinished":"2016-11-23T15:45:25+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:172","focus":true},{"text":"//Leyes por día\n//leyes.orderBy(\"date\").groupBy(\"date\").count().show()\n\n//Leyes por año\nprintln(\"Proyectos por Año:\")\ndef getYear: String => String = _.slice(0,4)\nval lawsPerYear = leyes.withColumn(\"Año\", udf(getYear).apply('date))\nlawsPerYear.groupBy(\"Año\").count().orderBy(\"año\").show()\n\n//Leyes por mes\nprintln(\"Proyectos por Mes:\")\ndef getYearMonth: String => String = _.dropRight(3)\nval lawsPerMonth = leyes.withColumn(\"Mes\", udf(getYearMonth).apply('date))\nlawsPerMonth.groupBy(\"Mes\").count().orderBy(\"Mes\").show(false)\n\n//Leyes por mes del año\nprintln(\"Proyectos por Mes del Año:\")\ndef getMonth: String => String = _.slice(5,7)\nval lawsPerMonthOfYear = leyes.withColumn(\"Mes del año\", udf(getMonth).apply('date))\nlawsPerMonthOfYear.groupBy(\"Mes del año\").count().orderBy(\"Mes del año\").show(false)","dateUpdated":"2016-11-23T16:09:58+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479581258710_1573200773","id":"20161119-194738_1933628077","result":{"code":"SUCCESS","type":"TEXT","msg":"Proyectos por Año:\n\ngetYear: String => String\n\nlawsPerYear: org.apache.spark.sql.DataFrame = [id: string, date: string ... 3 more fields]\n+----+-----+\n| Año|count|\n+----+-----+\n|2011| 1496|\n|2012| 2188|\n|2013| 1863|\n|2014| 2997|\n|2015| 1983|\n|2016| 2414|\n+----+-----+\n\nProyectos por Mes:\n\ngetYearMonth: String => String\n\nlawsPerMonth: org.apache.spark.sql.DataFrame = [id: string, date: string ... 3 more fields]\n+-------+-----+\n|Mes    |count|\n+-------+-----+\n|2011-03|482  |\n|2011-04|143  |\n|2011-05|129  |\n|2011-06|162  |\n|2011-07|94   |\n|2011-08|90   |\n|2011-09|104  |\n|2011-10|87   |\n|2011-11|141  |\n|2011-12|64   |\n|2012-01|3    |\n|2012-02|42   |\n|2012-03|807  |\n|2012-04|194  |\n|2012-05|216  |\n|2012-06|170  |\n|2012-07|96   |\n|2012-08|201  |\n|2012-09|133  |\n|2012-10|140  |\n+-------+-----+\nonly showing top 20 rows\n\nProyectos por Mes del Año:\n\ngetMonth: String => String\n\nlawsPerMonthOfYear: org.apache.spark.sql.DataFrame = [id: string, date: string ... 3 more fields]\n+-----------+-----+\n|Mes del año|count|\n+-----------+-----+\n|01         |8    |\n|02         |144  |\n|03         |3829 |\n|04         |1696 |\n|05         |1295 |\n|06         |982  |\n|07         |684  |\n|08         |1065 |\n|09         |956  |\n|10         |890  |\n|11         |963  |\n|12         |429  |\n+-----------+-----+\n\n"},"dateCreated":"2016-11-19T07:47:38+0100","dateStarted":"2016-11-23T16:09:58+0100","dateFinished":"2016-11-23T16:10:02+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173","focus":true},{"text":"val sancionados = resultados.filter($\"result\".contains(\"MEDIA SANCION\"))\n\n//Sancionados por año\nprintln(\"Sancionados por Año:\")\nsancionados.withColumn(\"Año\", udf(getYear).apply('date)).groupBy(\"Año\").count().orderBy(\"año\").show(false)\n\n//Sancionados por mes\nprintln(\"Sancionados por Mes:\")\nsancionados.withColumn(\"Mes\", udf(getYearMonth).apply('date)).groupBy(\"Mes\").count().orderBy(\"Mes\").show(false)\n\n//Sancionados por mes del año\nprintln(\"Sancionados por Mes del Año:\")\nsancionados.withColumn(\"Mes del año\", udf(getMonth).apply('date)).groupBy(\"Mes del año\").count().orderBy(\"Mes del año\").show(false)\n\n","dateUpdated":"2016-11-23T15:58:08+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479581737680_-843906188","id":"20161119-195537_1087168982","result":{"code":"SUCCESS","type":"TEXT","msg":"\nsancionados: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, chamber: string ... 2 more fields]\nSancionados por Año:\n+----+-----+\n|Año |count|\n+----+-----+\n|2011|31   |\n|2012|225  |\n|2013|110  |\n|2014|189  |\n|2015|171  |\n|2016|47   |\n+----+-----+\n\nSancionados por Mes:\n+-------+-----+\n|Mes    |count|\n+-------+-----+\n|2011-03|1    |\n|2011-05|1    |\n|2011-06|1    |\n|2011-09|3    |\n|2011-11|14   |\n|2011-12|11   |\n|2012-04|15   |\n|2012-05|5    |\n|2012-06|27   |\n|2012-08|13   |\n|2012-10|36   |\n|2012-11|129  |\n|2013-04|11   |\n|2013-06|15   |\n|2013-07|12   |\n|2013-09|17   |\n|2013-11|54   |\n|2013-12|1    |\n|2014-07|10   |\n|2014-08|19   |\n+-------+-----+\nonly showing top 20 rows\n\nSancionados por Mes del Año:\n+-----------+-----+\n|Mes del año|count|\n+-----------+-----+\n|03         |3    |\n|04         |32   |\n|05         |10   |\n|06         |69   |\n|07         |33   |\n|08         |50   |\n|09         |57   |\n|10         |57   |\n|11         |391  |\n|12         |71   |\n+-----------+-----+\n\n"},"dateCreated":"2016-11-19T07:55:37+0100","dateStarted":"2016-11-23T15:58:08+0100","dateFinished":"2016-11-23T15:58:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174","focus":true},{"text":"val mediaSancion = resultados.filter($\"result\".contains(\"MEDIA SANCION\"))\n\n//Medias sanciones por año\nprintln(\"Medias sanciones por Año:\")\nmediaSancion.withColumn(\"Año\", udf(getYear).apply('date)).groupBy(\"Año\").agg(countDistinct($\"id\")).orderBy(\"Año\").show(false)\n\n//Medias sanciones por mes\nprintln(\"Medias Sanciones por Mes:\")\nmediaSancion.withColumn(\"Mes\", udf(getYearMonth).apply('date)).groupBy(\"Mes\").agg(countDistinct($\"id\")).orderBy(\"Mes\").show(false)\n\n//Sancionados por mes del año\nprintln(\"Sancionados por Mes del Año:\")\nmediaSancion.withColumn(\"Mes del año\", udf(getMonth).apply('date)).groupBy(\"Mes del año\").agg(countDistinct($\"id\")).orderBy(\"Mes del año\").show(false)","dateUpdated":"2016-11-23T15:58:16+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479583794778_-1492187075","id":"20161119-202954_202626127","result":{"code":"SUCCESS","type":"TEXT","msg":"\nmediaSancion: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, chamber: string ... 2 more fields]\nMedias sanciones por Año:\n+----+------------------+\n|Año |count(DISTINCT id)|\n+----+------------------+\n|2011|31                |\n|2012|210               |\n|2013|110               |\n|2014|186               |\n|2015|171               |\n|2016|45                |\n+----+------------------+\n\nMedias Sanciones por Mes:\n+-------+------------------+\n|Mes    |count(DISTINCT id)|\n+-------+------------------+\n|2011-03|1                 |\n|2011-05|1                 |\n|2011-06|1                 |\n|2011-09|3                 |\n|2011-11|14                |\n|2011-12|11                |\n|2012-04|15                |\n|2012-05|5                 |\n|2012-06|27                |\n|2012-08|13                |\n|2012-10|36                |\n|2012-11|129               |\n|2013-04|11                |\n|2013-06|15                |\n|2013-07|12                |\n|2013-09|17                |\n|2013-11|54                |\n|2013-12|1                 |\n|2014-07|10                |\n|2014-08|19                |\n+-------+------------------+\nonly showing top 20 rows\n\nSancionados por Mes del Año:\n+-----------+------------------+\n|Mes del año|count(DISTINCT id)|\n+-----------+------------------+\n|03         |3                 |\n|04         |32                |\n|05         |10                |\n|06         |69                |\n|07         |33                |\n|08         |50                |\n|09         |57                |\n|10         |57                |\n|11         |387               |\n|12         |71                |\n+-----------+------------------+\n\n"},"dateCreated":"2016-11-19T08:29:54+0100","dateStarted":"2016-11-23T15:58:16+0100","dateFinished":"2016-11-23T15:58:24+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:175","focus":true},{"text":"val retirados = resultados.filter($\"result\".contains(\"RETIRADO\"))\n\n//Medias sanciones por año\nprintln(\"Retirados por Año:\")\nretirados.withColumn(\"Año\", udf(getYear).apply('date)).groupBy(\"Año\").count().orderBy(\"Año\").show(false)\n\n//Medias sanciones por mes\nprintln(\"Retirados por Mes:\")\nretirados.withColumn(\"Mes\", udf(getYearMonth).apply('date)).groupBy(\"Mes\").count().orderBy(\"Mes\").show(false)\n\n//Sancionados por mes del año\nprintln(\"Retirados por Mes del Año:\")\nretirados.withColumn(\"Mes del año\", udf(getMonth).apply('date)).groupBy(\"Mes del año\").count().orderBy(\"Mes del año\").show(false)","dateUpdated":"2016-11-23T15:58:27+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479589567528_-1057405567","id":"20161119-220607_729256170","result":{"code":"SUCCESS","type":"TEXT","msg":"\nretirados: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, chamber: string ... 2 more fields]\nRetirados por Año:\n+----+-----+\n|Año |count|\n+----+-----+\n|2011|5    |\n|2012|13   |\n|2013|4    |\n+----+-----+\n\nRetirados por Mes:\n+-------+-----+\n|Mes    |count|\n+-------+-----+\n|2011-11|5    |\n|2012-04|2    |\n|2012-05|1    |\n|2012-06|7    |\n|2012-08|1    |\n|2012-11|2    |\n|2013-03|2    |\n|2013-06|1    |\n|2013-07|1    |\n+-------+-----+\n\nRetirados por Mes del Año:\n+-----------+-----+\n|Mes del año|count|\n+-----------+-----+\n|03         |2    |\n|04         |2    |\n|05         |1    |\n|06         |8    |\n|07         |1    |\n|08         |1    |\n|11         |7    |\n+-----------+-----+\n\n"},"dateCreated":"2016-11-19T10:06:07+0100","dateStarted":"2016-11-23T15:58:27+0100","dateFinished":"2016-11-23T15:58:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:176","focus":true},{"text":"leyes.agg(count('id).as(\"Cantidad Total de Proyectos Presentados\")).show()\nval proyectosPresentados = leyes.count()\ndef getPercentage: Long => Float = _.toFloat / proyectosPresentados * 100\n\nvar agrupados = resultados.groupBy(\"result\").agg(countDistinct($\"id\").as(\"Cantidad\"))\nagrupados.withColumn(\"Porcentaje Sobre Proyectos Presentados\", udf(getPercentage).apply($\"Cantidad\")).show()\n","dateUpdated":"2016-11-23T15:58:36+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479590056203_-940540948","id":"20161119-221416_434910484","result":{"code":"SUCCESS","type":"TEXT","msg":"+---------------------------------------+\n|Cantidad Total de Proyectos Presentados|\n+---------------------------------------+\n|                                  12941|\n+---------------------------------------+\n\n\nproyectosPresentados: Long = 12941\n\ngetPercentage: Long => Float\n\nagrupados: org.apache.spark.sql.DataFrame = [result: string, Cantidad: bigint]\n+-------------+--------+--------------------------------------+\n|       result|Cantidad|Porcentaje Sobre Proyectos Presentados|\n+-------------+--------+--------------------------------------+\n|   SANCIONADO|     354|                             2.7354918|\n|     APROBADO|       2|                           0.015454757|\n|     RETIRADO|      22|                            0.17000231|\n|MEDIA SANCION|     714|                              5.517348|\n+-------------+--------+--------------------------------------+\n\n"},"dateCreated":"2016-11-19T10:14:16+0100","dateStarted":"2016-11-23T15:58:36+0100","dateFinished":"2016-11-23T15:58:40+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:177","focus":true},{"text":"//Proyectos totales por partido.\nfirmantes.groupBy($\"party\").agg(countDistinct($\"id\").as(\"Proyectos por Partido\")).orderBy(\"party\").show(100)","dateUpdated":"2016-11-23T16:12:44+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479747650663_-658451882","id":"20161121-180050_1746410658","dateCreated":"2016-11-21T06:00:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179","dateFinished":"2016-11-23T15:49:20+0100","dateStarted":"2016-11-23T15:49:17+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+---------------------+\n|               party|Proyectos por Partido|\n+--------------------+---------------------+\n|    AVANZAR SAN LUIS|                    7|\n|BLOQUE SOCIAL CRI...|                    2|\n|BRIGADIER GENERAL...|                    5|\n|  CHUBUT SOMOS TODOS|                   35|\n|    COALICION CIVICA|                  323|\n|COALICION CIVICA ...|                  298|\n|COALICION CIVICA ...|                  185|\n|COMPROMISO CON SA...|                   34|\n|  COMPROMISO FEDERAL|                  488|\n|  CONCERTACION FORJA|                   22|\n|    CONSENSO FEDERAL|                   14|\n| CONSERVADOR POPULAR|                  106|\n|     CORDOBA FEDERAL|                   78|\n|CORRIENTE DE PENS...|                   50|\n|CULTURA, EDUCACIO...|                  111|\n|  DE LA CONCERTACION|                   12|\n|    DEL BICENTENARIO|                   26|\n|DEMOCRACIA IGUALI...|                   86|\n|DEMOCRATA DE MENDOZA|                   89|\n|DEMOCRATA PROGRES...|                   41|\n|DIALOGO POR BUENO...|                   14|\n|   DIALOGO Y TRABAJO|                   22|\n|ENCUENTRO POR COR...|                   45|\n|                  FE|                   58|\n|FEDERAL UNIDOS PO...|                  372|\n|FRENTE CIVICO - C...|                  330|\n|FRENTE CIVICO POR...|                  149|\n|FRENTE CIVICO Y  ...|                    5|\n|FRENTE CIVICO Y S...|                  145|\n|FRENTE DE IZQUIER...|                  102|\n|FRENTE DE LA CONC...|                   22|\n|     FRENTE DE TODOS|                    7|\n|FRENTE NUEVO ENCU...|                   82|\n|FRENTE PARA LA VI...|                  200|\n|FRENTE PARA LA VI...|                 3940|\n|    FRENTE PERONISTA|                  541|\n|FRENTE PERONISTA ...|                   25|\n|FRENTE POR LA INC...|                   36|\n|    FRENTE RENOVADOR|                  400|\n|FRENTE RENOVADOR ...|                    8|\n|                 GEN|                 1007|\n|JUNTOS POR ARGENTINA|                   10|\n|       JUSTICIALISTA|                  213|\n|LIBERTAD VALORES ...|                   31|\n|LIBERTAD Y DEMOCR...|                    1|\n|      LIBRES DEL SUR|                  593|\n|    MOV POP FUEGUINO|                   30|\n|    MOV POP NEUQUINO|                  572|\n|MOVIMIENTO NACION...|                   14|\n|MOVIMIENTO PROYEC...|                  151|\n|MOVIMIENTO SOLIDA...|                   40|\n|NUCLEO UNIDAD PER...|                    6|\n|     NUEVO ENCUENTRO|                   51|\n|NUEVO ENCUENTRO P...|                   34|\n|PARTIDO DE LA CON...|                    9|\n|PARTIDO FEDERAL F...|                   49|\n|PARTIDO JUSTICIAL...|                  201|\n|PARTIDO JUSTICIAL...|                    1|\n|PARTIDO LIBERAL D...|                    5|\n|  PARTIDO SOCIALISTA|                  788|\n|   PERONISMO FEDERAL|                  198|\n|    PERONISMO JUJEÑO|                    6|\n|PERONISMO MAS AL SUR|                   23|\n|PERONISMO PARA LA...|                   64|\n|           PERONISTA|                   52|\n|     PODER EJECUTIVO|                    1|\n|     PRIMERO TUCUMAN|                   12|\n|                 PRO|                  516|\n| PROYECTO SUR - UNEN|                  168|\n|PTS - FRENTE DE I...|                   72|\n|  RENOVADOR DE SALTA|                   80|\n|   SALTA SOMOS TODOS|                  102|\n|SANTA FE EN MOVIM...|                   20|\n|SI POR LA UNIDAD ...|                   45|\n|   SOCIAL PATAGONICO|                   27|\n| SOCIALISTA DEL MIJD|                   73|\n|        SOLIDARIO SI|                   22|\n|         SUMA + UNEN|                   85|\n|  TRABAJO Y DIGNIDAD|                  205|\n|                 UCR|                 2608|\n|         UDESO SALTA|                  266|\n|UNIDAD PARA EL DE...|                   67|\n|      UNIDAD POPULAR|                  446|\n|UNIDOS POR UNA NU...|                  116|\n|UNION CELESTE Y B...|                  115|\n|     UNION PERONISTA|                   36|\n|   UNION POR CORDOBA|                   56|\n|UNION POR ENTRE RIOS|                   89|\n|  UNION POR SAN JUAN|                   22|\n|     UNION POR TODOS|                  144|\n|           UNION PRO|                  985|\n|         UNIPERSONAL|                    4|\n|                UNIR|                  397|\n|VALORES PARA MI PAIS|                    9|\n+--------------------+---------------------+\n\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479912412964_-1645575730","id":"20161123-154652_73931046","dateCreated":"2016-11-23T15:46:52+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:965","dateUpdated":"2016-11-23T16:11:03+0100","dateFinished":"2016-11-23T16:08:54+0100","dateStarted":"2016-11-23T16:08:51+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+----+------------------+\n|               party| Año|count(DISTINCT id)|\n+--------------------+----+------------------+\n|    AVANZAR SAN LUIS|2016|                 7|\n|BLOQUE SOCIAL CRI...|2015|                 1|\n|BLOQUE SOCIAL CRI...|2016|                 1|\n|BRIGADIER GENERAL...|2016|                 5|\n|  CHUBUT SOMOS TODOS|2016|                35|\n|    COALICION CIVICA|2011|               218|\n|    COALICION CIVICA|2016|               105|\n|COALICION CIVICA ...|2011|                 4|\n|COALICION CIVICA ...|2012|               191|\n|COALICION CIVICA ...|2013|               103|\n|COALICION CIVICA ...|2014|               138|\n|COALICION CIVICA ...|2015|                47|\n|COMPROMISO CON SA...|2016|                34|\n|  COMPROMISO FEDERAL|2013|                19|\n|  COMPROMISO FEDERAL|2014|               211|\n|  COMPROMISO FEDERAL|2015|               105|\n|  COMPROMISO FEDERAL|2016|               153|\n|  CONCERTACION FORJA|2016|                22|\n|    CONSENSO FEDERAL|2011|                14|\n| CONSERVADOR POPULAR|2014|                64|\n+--------------------+----+------------------+\nonly showing top 20 rows\n\n"},"text":"//Proyectos presentados por partido por año.\nfirmantes.join(lawsPerYear, \"id\").groupBy($\"party\", $\"Año\").agg(countDistinct($\"id\")).orderBy(\"party\", \"Año\").show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479913231711_606921119","id":"20161123-160031_2129247698","dateCreated":"2016-11-23T16:00:31+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1228","dateUpdated":"2016-11-23T16:10:53+0100","dateFinished":"2016-11-23T16:10:56+0100","dateStarted":"2016-11-23T16:10:53+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+-------+------------------+\n|               party|    Mes|count(DISTINCT id)|\n+--------------------+-------+------------------+\n|    AVANZAR SAN LUIS|2016-03|                 1|\n|    AVANZAR SAN LUIS|2016-04|                 1|\n|    AVANZAR SAN LUIS|2016-05|                 2|\n|    AVANZAR SAN LUIS|2016-07|                 1|\n|    AVANZAR SAN LUIS|2016-08|                 1|\n|    AVANZAR SAN LUIS|2016-10|                 1|\n|BLOQUE SOCIAL CRI...|2015-09|                 1|\n|BLOQUE SOCIAL CRI...|2016-02|                 1|\n|BRIGADIER GENERAL...|2016-05|                 3|\n|BRIGADIER GENERAL...|2016-06|                 1|\n|BRIGADIER GENERAL...|2016-10|                 1|\n|  CHUBUT SOMOS TODOS|2016-03|                 5|\n|  CHUBUT SOMOS TODOS|2016-04|                 8|\n|  CHUBUT SOMOS TODOS|2016-05|                 3|\n|  CHUBUT SOMOS TODOS|2016-06|                 4|\n|  CHUBUT SOMOS TODOS|2016-07|                 1|\n|  CHUBUT SOMOS TODOS|2016-08|                 8|\n|  CHUBUT SOMOS TODOS|2016-09|                 2|\n|  CHUBUT SOMOS TODOS|2016-10|                 4|\n|    COALICION CIVICA|2011-03|                74|\n+--------------------+-------+------------------+\nonly showing top 20 rows\n\n"},"text":"//Proyectos presentados por partido por mes.\nfirmantes.join(lawsPerMonth, \"id\").groupBy($\"party\", $\"Mes\").agg(countDistinct($\"id\")).orderBy(\"party\", \"Mes\").show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479913853226_-89802776","id":"20161123-161053_1399982865","dateCreated":"2016-11-23T16:10:53+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1511","dateUpdated":"2016-11-23T16:12:17+0100","dateFinished":"2016-11-23T16:11:34+0100","dateStarted":"2016-11-23T16:11:30+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+-----------+------------------+\n|               party|Mes del Año|count(DISTINCT id)|\n+--------------------+-----------+------------------+\n|    AVANZAR SAN LUIS|         03|                 1|\n|    AVANZAR SAN LUIS|         04|                 1|\n|    AVANZAR SAN LUIS|         05|                 2|\n|    AVANZAR SAN LUIS|         07|                 1|\n|    AVANZAR SAN LUIS|         08|                 1|\n|    AVANZAR SAN LUIS|         10|                 1|\n|BLOQUE SOCIAL CRI...|         02|                 1|\n|BLOQUE SOCIAL CRI...|         09|                 1|\n|BRIGADIER GENERAL...|         05|                 3|\n|BRIGADIER GENERAL...|         06|                 1|\n|BRIGADIER GENERAL...|         10|                 1|\n|  CHUBUT SOMOS TODOS|         03|                 5|\n|  CHUBUT SOMOS TODOS|         04|                 8|\n|  CHUBUT SOMOS TODOS|         05|                 3|\n|  CHUBUT SOMOS TODOS|         06|                 4|\n|  CHUBUT SOMOS TODOS|         07|                 1|\n|  CHUBUT SOMOS TODOS|         08|                 8|\n|  CHUBUT SOMOS TODOS|         09|                 2|\n|  CHUBUT SOMOS TODOS|         10|                 4|\n|    COALICION CIVICA|         03|               142|\n+--------------------+-----------+------------------+\nonly showing top 20 rows\n\n"},"text":"//Proyectos presentados por partido por mes del año.\nfirmantes.join(lawsPerMonthOfYear, \"id\").groupBy($\"party\", $\"Mes del Año\").agg(countDistinct($\"id\")).orderBy(\"party\", \"Mes del Año\").show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479914118934_-1371245952","id":"20161123-161518_1249387186","dateCreated":"2016-11-23T16:15:18+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1691","text":"firmantes.printSchema()\nresultados.printSchema()","dateUpdated":"2016-11-23T16:41:06+0100","dateFinished":"2016-11-23T16:41:06+0100","dateStarted":"2016-11-23T16:41:06+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- id: string (nullable = true)\n |-- congressman: string (nullable = true)\n |-- district: string (nullable = true)\n |-- party: string (nullable = true)\n\nroot\n |-- id: string (nullable = true)\n |-- chamber: string (nullable = true)\n |-- result: string (nullable = true)\n |-- date: string (nullable = true)\n\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479913890237_-192469435","id":"20161123-161130_893023380","dateCreated":"2016-11-23T16:11:30+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1592","dateUpdated":"2016-11-23T16:16:03+0100","dateFinished":"2016-11-23T16:16:06+0100","dateStarted":"2016-11-23T16:16:03+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+-----------+---------------------+\n|         id|Cantidad de Firmantes|\n+-----------+---------------------+\n|0001-D-2011|                    1|\n|0002-D-2011|                    1|\n|0002-D-2014|                    6|\n|0003-D-2012|                    6|\n|0003-D-2013|                    1|\n|0003-D-2014|                    8|\n|0003-D-2015|                   12|\n|0004-D-2013|                    1|\n|0004-D-2014|                    4|\n|0004-D-2015|                    8|\n|0005-D-2011|                    3|\n|0005-D-2012|                    3|\n|0005-D-2013|                    1|\n|0005-D-2014|                    4|\n|0005-D-2015|                    6|\n|0005-D-2016|                    1|\n|0006-D-2011|                    5|\n|0006-D-2012|                    4|\n|0006-D-2013|                    2|\n|0006-D-2015|                    6|\n+-----------+---------------------+\nonly showing top 20 rows\n\n"},"text":"firmantes.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"Cantidad de Firmantes\")).orderBy(\"id\").show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479914150609_-773300189","id":"20161123-161550_1595936538","dateCreated":"2016-11-23T16:15:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1767","dateUpdated":"2016-11-23T16:58:20+0100","dateFinished":"2016-11-23T16:58:21+0100","dateStarted":"2016-11-23T16:58:20+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ngetAmountOfMonths: Long => Long\n\ntimeMediaSancion: org.apache.spark.sql.DataFrame = [id: string, presentationdate: string ... 4 more fields]\n\ntimeSancion: org.apache.spark.sql.DataFrame = [id: string, presentationdate: string ... 4 more fields]\n"},"text":"def getAmountOfMonths: Long => Long = _.toLong / 30\n\n\n//Tiempo hasta conseguir media sanción\nval timeMediaSancion = resultados.select($\"id\", $\"result\", $\"date\".alias(\"resultdate\")).join(leyes, \"id\").select($\"id\",$\"date\".alias(\"presentationdate\"),$\"result\",$\"resultdate\").withColumn(\"Diferencia (Días)\", datediff($\"resultdate\", $\"presentationdate\")).filter($\"result\" === \"MEDIA SANCION\").withColumn(\"Diferencia (Meses)\", udf(getAmountOfMonths).apply($\"Diferencia (Días)\"))\n\n//Tiempo hasta conseguir sanción completa\nval timeSancion = resultados.select($\"id\", $\"result\", $\"date\".alias(\"resultdate\")).join(leyes, \"id\").select($\"id\",$\"date\".alias(\"presentationdate\"),$\"result\",$\"resultdate\").withColumn(\"Diferencia (Días)\", datediff($\"resultdate\", $\"presentationdate\")).filter($\"result\" === \"SANCIONADO\").withColumn(\"Diferencia (Meses)\", udf(getAmountOfMonths).apply($\"Diferencia (Días)\"))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479915369651_1606514609","id":"20161123-163609_1230029729","dateCreated":"2016-11-23T16:36:09+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1860","dateUpdated":"2016-11-23T23:06:42+0100","dateFinished":"2016-11-23T23:06:45+0100","dateStarted":"2016-11-23T23:06:42+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\nhistogramMediaSancion: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Diferencia (Meses): bigint, # Proyectos: bigint]\n+------------------+-----------+\n|Diferencia (Meses)|# Proyectos|\n+------------------+-----------+\n|                 0|         26|\n|                 1|         38|\n|                 2|         49|\n|                 3|         57|\n|                 4|         55|\n|                 5|         55|\n|                 6|         60|\n|                 7|         57|\n|                 8|         63|\n|                 9|         16|\n|                10|         13|\n|                11|         22|\n|                12|         24|\n|                13|         23|\n|                14|         23|\n|                15|         23|\n|                16|         26|\n|                17|         26|\n|                18|         27|\n|                19|         34|\n|                20|         34|\n|                21|          9|\n|                22|          2|\n|                24|          3|\n|                26|          2|\n|                29|          1|\n|                30|          3|\n|                33|          2|\n+------------------+-----------+\n\n"},"text":"val histogramMediaSancion = timeMediaSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\nhistogramMediaSancion.show(100)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479916768834_-2076306272","id":"20161123-165928_1330376200","dateCreated":"2016-11-23T16:59:28+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2088","dateUpdated":"2016-11-23T23:06:58+0100","dateFinished":"2016-11-23T23:07:01+0100","dateStarted":"2016-11-23T23:06:58+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\nhistogramSancion: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Diferencia (Meses): bigint, # Proyectos: bigint]\n+------------------+-----------+\n|Diferencia (Meses)|# Proyectos|\n+------------------+-----------+\n|                 0|         19|\n|                 1|         11|\n|                 2|         12|\n|                 3|         16|\n|                 4|          6|\n|                 5|         13|\n|                 6|         16|\n|                 7|         19|\n|                 8|         24|\n|                 9|         11|\n|                10|          2|\n|                11|          5|\n|                12|         12|\n|                13|         13|\n|                14|         10|\n|                15|         10|\n|                16|          3|\n|                17|          7|\n|                18|          8|\n|                19|         14|\n|                20|         20|\n|                21|          6|\n|                22|          7|\n|                23|          9|\n|                24|         12|\n|                25|          9|\n|                26|          3|\n|                27|          7|\n|                28|          6|\n|                29|          4|\n|                30|          5|\n|                31|         13|\n|                32|          8|\n|                33|          2|\n|                34|          2|\n|                35|          2|\n|                36|          1|\n|                37|          1|\n|                39|          1|\n|                42|          2|\n|                43|          1|\n|                44|          2|\n+------------------+-----------+\n\n"},"text":"val histogramSancion = timeSancion.groupBy(\"Diferencia (Meses)\").agg(countDistinct(\"id\").as(\"# Proyectos\")).orderBy(\"Diferencia (Meses)\")\nhistogramSancion.show(100)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479916819203_682236072","id":"20161123-170019_1255622331","dateCreated":"2016-11-23T17:00:19+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2172","dateUpdated":"2016-11-23T18:42:22+0100","dateFinished":"2016-11-23T18:42:22+0100","dateStarted":"2016-11-23T18:42:22+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- id: string (nullable = true)\n |-- congressman: string (nullable = true)\n |-- district: string (nullable = true)\n |-- party: string (nullable = true)\n\n"},"text":"firmantes.printSchema()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479922942383_-1755337402","id":"20161123-184222_1304745763","dateCreated":"2016-11-23T18:42:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2792","dateUpdated":"2016-11-23T22:57:42+0100","dateFinished":"2016-11-23T22:57:00+0100","dateStarted":"2016-11-23T22:56:40+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+----------------------+\n|         congressman|#Proyectos Presentados|\n+--------------------+----------------------+\n|RECALDE, HECTOR P...|                   630|\n|BIANCHI, IVANA MARIA|                   573|\n|DONDA PEREZ, VICT...|                   552|\n|ASSEFF, ALBERTO E...|                   474|\n|DUCLOS, OMAR ARNALDO|                   410|\n|LINARES, MARIA VI...|                   392|\n|  BULLRICH, PATRICIA|                   374|\n|COMELLI, ALICIA M...|                   371|\n|    PINEDO, FEDERICO|                   303|\n|CARRIO, ELISA MAR...|                   298|\n|MILMAN, GERARDO F...|                   288|\n|PERALTA, FABIAN F...|                   285|\n|MARTINEZ, JULIO C...|                   279|\n|STOLBIZER, MARGAR...|                   274|\n|SCHMIDT LIERMANN,...|                   269|\n|CICILIANI, ALICIA...|                   268|\n|BIELLA CALVET, BE...|                   267|\n|CONTI, DIANA BEATRIZ|                   263|\n|ARGUMEDO, ALCIRA ...|                   256|\n|    PAIS, JUAN MARIO|                   253|\n+--------------------+----------------------+\nonly showing top 20 rows\n\n+--------------------+----------------------+\n|         congressman|#Proyectos Presentados|\n+--------------------+----------------------+\n|SATRAGNO, LIDIA ELSA|                     1|\n|BETTANIN, JUAN CA...|                     1|\n| LORGES, JUAN CARLOS|                     1|\n|       MONZO, EMILIO|                     1|\n|      SOSA , SOLEDAD|                     1|\n|BELLOCQ, GERARDO ...|                     1|\n|ASEF, DANIEL EDGARDO|                     2|\n|MONTOYA, JORGE LU...|                     2|\n|DEL CAMPILLO, HEC...|                     2|\n|KORENFELD, BEATRI...|                     2|\n|GOMEZ, MAURICIO R...|                     2|\n|ROSSI, ALEJANDRO ...|                     2|\n|ALEGRE, OSCAR GIL...|                     2|\n|LEGUIZAMON, MARIA...|                     2|\n|FELLNER, EDUARDO ...|                     3|\n|DUTTO, GUSTAVO AL...|                     3|\n|FIOL, PAULINA ESTHER|                     3|\n|PEREYRA, GUILLERM...|                     3|\n| DIAZ, SUSANA ELADIA|                     3|\n|ALFARO, GERMAN EN...|                     3|\n+--------------------+----------------------+\nonly showing top 20 rows\n\n\npartidosPorProyecto: org.apache.spark.sql.DataFrame = [id: string, #Partidos por Proyecto: bigint]\n+-----------+----------------------+\n|         id|#Partidos por Proyecto|\n+-----------+----------------------+\n|2452-D-2016|                    20|\n|2249-D-2014|                    15|\n|4161-D-2016|                    14|\n|1394-D-2014|                    13|\n|1145-D-2013|                    12|\n|1146-D-2013|                    12|\n|1218-D-2012|                    11|\n|2963-D-2014|                    11|\n|1460-D-2012|                    11|\n|2386-D-2015|                    11|\n|6021-D-2014|                    11|\n|4403-D-2014|                    11|\n|1029-D-2016|                    10|\n|7086-D-2012|                    10|\n|2600-D-2013|                    10|\n|2809-D-2014|                    10|\n|5963-D-2011|                    10|\n|9828-D-2014|                    10|\n|8642-D-2014|                    10|\n|2575-D-2014|                    10|\n+-----------+----------------------+\nonly showing top 20 rows\n\n+-------------------------------------------+\n|Promedio de partidos firmantes por proyecto|\n+-------------------------------------------+\n|                         1.5031295881307472|\n+-------------------------------------------+\n\n\nrowMaxOverTwo: Float = 6470.5\n+--------------------------------+\n|Mediana de Partidos por Proyecto|\n+--------------------------------+\n|1.0                             |\n+--------------------------------+\n\n+-----------+-----------------------+\n|         id|#Diputados por Proyecto|\n+-----------+-----------------------+\n|2249-D-2014|                     67|\n|2452-D-2016|                     67|\n|1218-D-2012|                     59|\n|4161-D-2016|                     40|\n|1460-D-2012|                     35|\n|1459-D-2014|                     27|\n|0327-D-2016|                     26|\n|4409-D-2013|                     26|\n|0328-D-2016|                     26|\n|4923-D-2014|                     25|\n|3880-D-2015|                     25|\n|6659-D-2014|                     23|\n|4844-D-2016|                     22|\n|6162-D-2014|                     21|\n|5240-D-2015|                     21|\n|3373-D-2015|                     21|\n|2575-D-2014|                     20|\n|2205-D-2013|                     20|\n|2527-D-2016|                     20|\n|3763-D-2014|                     19|\n+-----------+-----------------------+\nonly showing top 20 rows\n\n"},"text":"//Top 20 Cantidad de proyectos presentados por diputado\nfirmantes.groupBy(\"congressman\").agg(countDistinct(\"id\").as(\"#Proyectos Presentados\")).sort(desc(\"#Proyectos Presentados\")).show(20)\n\n//Bottom 20 Cantidad de proyectos presentados por diputado\nfirmantes.groupBy(\"congressman\").agg(countDistinct(\"id\").as(\"#Proyectos Presentados\")).sort(asc(\"#Proyectos Presentados\")).show(20)\n\n//Cantidad de partidos firmantes por proyecto\nval partidosPorProyecto = firmantes.groupBy(\"id\").agg(countDistinct(\"party\").as(\"#Partidos por Proyecto\"))\n\n//Top 20\npartidosPorProyecto.sort(desc(\"#Partidos por Proyecto\")).show()\n\npartidosPorProyecto.select(avg(\"#Partidos por Proyecto\").as(\"Promedio de partidos firmantes por proyecto\")).show()\n\nval rowMaxOverTwo = partidosPorProyecto.count.toFloat / 2\npartidosPorProyecto.select($\"#Partidos por Proyecto\", row_number.over(Window.orderBy($\"#Partidos por Proyecto\")).as(\"rowIndex\"))\n    .select($\"#Partidos por Proyecto\", $\"rowIndex\", ($\"rowIndex\" - rowMaxOverTwo).as(\"filterRow\")).where($\"filterRow\" >= 0 && $\"filterRow\" <= 1)\n    .agg(avg($\"#Partidos por Proyecto\").as(\"Mediana de Partidos por Proyecto\")).show(false)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479923002899_2023758240","id":"20161123-184322_700111182","dateCreated":"2016-11-23T18:43:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2871","dateUpdated":"2016-11-23T23:01:35+0100","dateFinished":"2016-11-23T23:01:44+0100","dateStarted":"2016-11-23T23:01:35+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndiputadosPorProyecto: org.apache.spark.sql.DataFrame = [id: string, #Diputados por Proyecto: bigint]\n+--------------------------------------------+\n|Promedio de diputados firmantes por proyecto|\n+--------------------------------------------+\n|                          3.3763233134997295|\n+--------------------------------------------+\n\n\nrowMaxOverTwo2: Float = 6470.5\n+---------------------------------+\n|Mediana de Diputados por Proyecto|\n+---------------------------------+\n|2.0                              |\n+---------------------------------+\n\n"},"text":"val diputadosPorProyecto = firmantes.groupBy(\"id\").agg(countDistinct(\"congressman\").as(\"#Diputados por Proyecto\"))\n\ndiputadosPorProyecto.select(avg(\"#Diputados por Proyecto\").as(\"Promedio de diputados firmantes por proyecto\")).show()\n\nval rowMaxOverTwo2 = diputadosPorProyecto.count.toFloat / 2\ndiputadosPorProyecto.select($\"#Diputados por Proyecto\", row_number.over(Window.orderBy($\"#Diputados por Proyecto\")).as(\"rowIndex\"))\n    .select($\"#Diputados por Proyecto\", $\"rowIndex\", ($\"rowIndex\" - rowMaxOverTwo2).as(\"filterRow\")).where($\"filterRow\" >= 0 && $\"filterRow\" <= 1)\n    .agg(avg($\"#Diputados por Proyecto\").as(\"Mediana de Diputados por Proyecto\")).show(false)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479938354841_805703619","id":"20161123-225914_761807549","dateCreated":"2016-11-23T22:59:14+0100","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3149","dateUpdated":"2016-11-23T22:59:25+0100","text":""}],"name":"HCDN","id":"2C43K64TY","angularObjects":{"2C1MQXXPR:shared_process":[],"2C2SK39AY:shared_process":[],"2C2VMCPCK:shared_process":[],"2C1CV94N5:shared_process":[],"2C2EM31B5:shared_process":[],"2C3CRJU94:shared_process":[],"2C1MWDD4Z:shared_process":[],"2C4X9WTVF:shared_process":[],"2C11MD99T:shared_process":[],"2C2AHWAX3:shared_process":[],"2C1SR6B3P:shared_process":[],"2C2BEDYEA:shared_process":[],"2C13YP3BG:shared_process":[],"2C4NNKJHG:shared_process":[],"2C16U4W7S:shared_process":[],"2C2Y92KWA:shared_process":[],"2C372HDTH:shared_process":[],"2C2KWGF2S:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}